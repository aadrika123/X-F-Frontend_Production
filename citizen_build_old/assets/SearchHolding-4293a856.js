import{t as re,r as o,g as se,ad as ae,a as oe,c as ne,d as g,b as ie,j as e,p as de,bM as ce,a1 as d,bN as xe,bO as be,bx as he,l as f,v as me,f as ue}from"./index-17dac803.js";import{b as pe}from"./index.esm-8cff07a8.js";import ge from"./OtpCard-f1e4e047.js";import fe from"./MobileNoCard-b18c64c2.js";function Pe(){const{t:a}=re(),[C,n]=o.useState(!1),[i,F]=o.useState(),[T,y]=o.useState(!1),[P,h]=o.useState(null),[ye,E]=o.useState(null),[O,m]=o.useState("");o.useState();const{notify:c}=o.useContext(se),[H,N]=o.useState(!1),[B,L]=o.useState(null),[D,I]=o.useState(!1),[A,V]=o.useState(null),[q,u]=o.useState(!1),[j,U]=o.useState([]),[Z,w]=o.useState(!1),[v,_]=o.useState([]);ae("Search Property");const{api_getAllUlb:Ne,api_sendMobileOtp:R,unauth_ward_by_zone:W,unauth_search_property:z}=ue(),$=oe(),G={id:P,setId:h,showDemandStatus:Z,setshowDemandStatus:w,data:i},k=t=>{u(!1),I(!1),m(""),y(!1),n(!0);let l={zone:s.values.zone,wardId:s.values.wardId,parameter:s.values.parameter,filteredBy:s.values.filterBy||"propertyNo",propId:s.values.propId};console.log("before fetch holding details....",l),f.post(z,l).then(r=>{var x,b,M;console.log("search property list",(x=r==null?void 0:r.data)==null?void 0:x.data),(b=r==null?void 0:r.data)!=null&&b.status?(F((M=r==null?void 0:r.data)==null?void 0:M.data),y(!0),m(""),E(l==null?void 0:l.ulbId)):(c("This holding no does not exits!","error"),m("Data not found. Please enter a valid holding no. or related ULB")),n(!1)}).catch(r=>{console.log("Error while fetching Filter Data",r),c("Something went wrong!!","error"),m("Network problem."),p(!0,"Error occured. Please try again later."),n(!1),y(!1)})},J=ne({filterBy:g().required("This is a required field."),zone:g().required("This is a required field."),wardId:g().required("This is a required field."),parameter:g().required("This is a required field.")}),s=ie({initialValues:{filterBy:"",zone:"",wardId:"",parameter:"",propId:""},onSubmit:t=>{console.log("at submit form.....",t),h(null),w(!1),k()},validationSchema:J}),K=(t,l)=>{alert(t+" hh "+l),s.setFieldValue("parameter",l),s.setFieldValue("propId",t),k(),_([])},Q=t=>{let l=t.target.name,r=t.target.value;l=="holdingNo"&&s.setFieldValue("holdingNo",be(r,s.values.holdingNo,17)),l=="zone"&&le(r)},X=t=>{n(!0),h(null),w(!1);let l={zone:s.values.zone,wardId:s.values.wardId,parameter:t,filteredBy:s.values.filterBy||"propertyNo"};if((l==null?void 0:l.zone)==""||(l==null?void 0:l.wardId)==""||(l==null?void 0:l.filteredBy)==""){he("Fill all fields to search for property ");return}f.post(z,l).then(r=>{console.log("property response",r.data.data),r.data.status&&_(r.data.data.data),n(!1)}).catch(r=>{console.log(r),n(!1)})},S=(t=null)=>{console.log("passed mobile no....."),n(!0);let l;t==null?l={mobileNo:B}:l={mobileNo:t},console.log("before send otp. of direct search..",l),f.post(R,l).then(r=>{var x,b;console.log("otp send response",r==null?void 0:r.data),(x=r==null?void 0:r.data)!=null&&x.status?(N(!0),c("OTP is send to your mobile no.","success")):(c((b=r==null?void 0:r.data)==null?void 0:b.message,"error"),p(!0,"Error occured. Please try again later.")),n(!1)}).catch(r=>{console.log("error otp send",r),p(!0,"Error occured. Please try again later."),n(!1)})},Y=()=>{c("Mobile no. has been verified successfully !","success"),$(`/viewDemandHoldingPropertyDirect/${P}`)},ee=()=>{N(!1)},p=(t,l)=>{V(l),I(t)},te=(t,l)=>{console.log("incoming data => ",t,l),h(t),l==""||l==null||l==null?(u(!0),console.log("entered in condition")):(u(!1),L(l),S(l))},le=t=>{n(!0);let l={zoneId:t};console.log("before fetch wardby old ward...",l),f.post(W,l,me()).then(function(r){console.log("wardlist by zone id list ....",r.data.data),U(r.data.data),n(!1)}).catch(function(r){console.log("errorrr.... ",r),n(!1)})};if(H)return e.jsx(ge,{closeOtpModal:ee,bottomNaviation:!0,headTitle:a("tranSearchHoldingPage.payPropertyTaxLabel.label"),reSendOtp:S,verifedMobileNo:B,callback:Y,setotpCardStatus:N});if(!H)return e.jsxs(e.Fragment,{children:[q&&e.jsx(fe,{title:"Enter Mobile No.",desc:"Enter mobile no. to proceed for payment",setverifedMobileNo:t=>{L(t),S(t)},closeMobileModal:()=>u(!1)}),D&&e.jsx(de,{activateBottomErrorCard:p,errorTitle:A}),e.jsxs("div",{className:"px-2 md:px-10 py-4 rounded-l bg-white border-0 border-slate-200 md:w-11/12 min-h-fit mx-auto shadow shadow-indigo-400 ",children:[e.jsxs("div",{className:"border shadow-xl bg-white mt-6",children:[e.jsxs("div",{className:"flex justify-between ml-5 mt-2 ",children:[e.jsx("p",{className:"font-semibold text-3xl ml-4 mt-1 text-gray-600",children:a("tranSearchHoldingPage.searchPropertyLabel.label")}),C&&e.jsxs("div",{className:"text-blue-500 p-4 font-bold",children:[" ",ce("lg")]})]}),e.jsx("form",{onSubmit:s.handleSubmit,onChange:Q,children:e.jsxs("div",{className:"w-full  pl-10 pr-4 grid grid-cols-1 md:grid-cols-5 gap-4 py-12",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"min-w-[80px] whitespace-nowrap mx-2  form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[a("tranSearchHoldingPage.searchPropertyLabel.label"),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...s.getFieldProps("filterBy"),className:"min-w-[80px] mx-2  cypress_filterBy cursor-pointer w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",selected:!0,children:a("tranSearchHoldingPage.selectLabel.label")}),e.jsx("option",{value:"propertyNo",children:"Property No"}),e.jsx("option",{value:"holdingNo",children:"Holding No."}),e.jsx("option",{value:"ownerName",children:"Owner Name"}),e.jsx("option",{value:"mobileNo",children:"Mobile No"})]}),e.jsx("p",{className:"text-red-500 text-xs",children:s.touched.filterBy&&s.errors.filterBy?s.errors.filterBy:null})]}),e.jsxs("div",{className:"",children:[e.jsxs("label",{className:"min-w-[80px] mx-2  form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[a("tranSearchHoldingPage.zoneLabel.label"),e.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e.jsxs("select",{id:"basic_details_1",...s.getFieldProps("zone"),className:"min-w-[80px] mx-2  form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md cursor-pointer ",children:[e.jsx("option",{value:"",selected:!0,children:a("tranSearchHoldingPage.selectLabel.label")}),e.jsx("option",{value:"1",children:"Zone A-East"}),e.jsx("option",{value:"2",children:"Zone B-West"}),e.jsx("option",{value:"3",children:"Zone C-North"}),e.jsx("option",{value:"4",children:"Zone D-South"})]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:s.touched.zone&&s.errors.zone?s.errors.zone:null})]}),e.jsxs("div",{className:"",children:[e.jsxs("label",{className:"min-w-[80px] mx-2  form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[a("tranSearchHoldingPage.wardNoLabel.label"),e.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e.jsxs("select",{id:"basic_details_1",...s.getFieldProps("wardId"),className:"min-w-[80px] mx-2  form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md cursor-pointer ",children:[e.jsx("option",{value:"",disabled:!0,selected:!0,children:a("tranSearchHoldingPage.selectLabel.label")}),j==null?void 0:j.map((t,l)=>e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.ward_name},l))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:s.touched.zone&&s.errors.zone?s.errors.zone:null})]}),e.jsxs("div",{className:"",children:[e.jsxs("label",{className:"min-w-[80px] mx-2  form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[s.values.filterBy=="propertyNo"&&a("tranSearchHoldingPage.oldPropertyNo.label"),s.values.filterBy=="holdingNo"&&a("tranSearchHoldingPage.propertyHoldingNumber.label"),s.values.filterBy=="ownerName"&&a("tranSearchHoldingPage.holdingOwnersName.label"),s.values.filterBy=="mobileNo"&&a("tranSearchHoldingPage.holdingMobileNumber.label"),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...s.getFieldProps("parameter"),onBlur:t=>X(t.target.value),className:" min-w-[80px] mx-2 w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e.jsx("p",{className:"text-red-500 text-xs",children:s.touched.parameter&&s.errors.parameter?s.errors.parameter:null}),e.jsx("div",{className:"min-w-[100px] border-0 relative border-cyan-500 bg-cyan-50 text-amber-800 font-semibold text-xs max-h-24 overflow-y-auto shadow",children:e.jsx("ul",{children:v==null?void 0:v.map((t,l)=>e.jsxs("li",{className:"pl-4 py-2 border-b cursor-pointer hover:text-amber-900 hover:scale-100 hover:bg-cyan-100",onClick:()=>K(t==null?void 0:t.id,t==null?void 0:t.property_no),children:[t==null?void 0:t.property_no," "]},l))})})]}),e.jsx("div",{className:"max-h-12 mt-6",children:e.jsxs("button",{type:"submit",className:"w-full border whitespace-nowrap  border-indigo-500 bg-indigo-600 hover:bg-indigo-500 text-white hover:text-black shadow-lg rounded-sm text-sm font-semibold py-2",children:[e.jsx(pe,{className:"inline mr-2"}),a("tranSearchHoldingPage.searchRecordLabel.label")]})})]})})]}),e.jsxs("div",{className:"mt-10",children:[T&&(i==null?void 0:i.length)>0?e.jsxs("div",{className:"col-span-10 bg-gray-50 p-4 overflow-x-scroll",children:[e.jsx("div",{className:"flex flex-row",children:e.jsx("h1",{className:"px-1 font-semibold font-serif text-2xl mt-4",children:a("tranSearchHoldingPage.allTransactionsLabel.label")})}),e.jsxs("table",{className:"min-w-full leading-normal mt-10",children:[e.jsx("thead",{className:"font-bold text-left text-sm bg-indigo-50 text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"#"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:a("tranSearchHoldingPage.actionLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:a("tranSearchHoldingPage.ownersNameLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:a("tranSearchHoldingPage.holdingNoLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:a("tranSearchHoldingPage.newHoldingNoLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:a("tranSearchHoldingPage.mobileNoLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:a("tranSearchHoldingPage.wardNoLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:a("tranSearchHoldingPage.ulbLabel2.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:a("tranSearchHoldingPage.addressLabel.label")})]})}),e.jsx("tbody",{className:"text-sm",children:e.jsx(e.Fragment,{children:i==null?void 0:i.map(t=>e.jsxs("tr",{className:"bg-white shadow-lg border-b border-gray-200",children:[e.jsx("td",{className:"px-2 py-2 text-sm text-left",children:"1"}),e.jsxs("td",{className:"px-2 py-2 text-sm text-left",children:[" ",e.jsx("button",{onClick:()=>te(t==null?void 0:t.id,t==null?void 0:t.mobile_no),className:"bg-sky-200 px-3 py-1 rounded-lg shadow-lg hover:shadow-xl hover:bg-sky-800 hover:text-white text-black",children:a("tranSearchHoldingPage.viewLabel.label")})]}),e.jsx("td",{className:"px-2 py-2 text-sm text-left",children:d(t==null?void 0:t.owner_name)}),e.jsx("td",{className:"px-2 py-2 text-sm text-left",children:d(t==null?void 0:t.holding_no)}),e.jsx("td",{className:"px-2 py-2 text-sm text-left",children:d(t==null?void 0:t.new_holding_no)}),e.jsx("td",{className:"px-2 py-2 text-sm text-left",children:d(t==null?void 0:t.mobile_no)}),e.jsx("td",{className:"px-2 py-2 text-sm text-left",children:d(t==null?void 0:t.ward_name)}),e.jsx("td",{className:"px-2 py-2 text-sm text-left",children:d(t==null?void 0:t.ulb)}),e.jsx("td",{className:"px-2 py-2 text-sm text-left",children:d(t==null?void 0:t.prop_address)})]}))})})]})]}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-sm "})}),e.jsx(xe,{values:G}),e.jsx("div",{className:"text-xl font-semibold text-red-400 text-center",children:O}),e.jsx("div",{className:"w-full h-40"})]})]})]})}export{Pe as default};
