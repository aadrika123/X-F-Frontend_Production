import{r as n,aQ as D,j as t,aT as Q,cM as q,k as J,o as X,be as K,A as k,N as F,cK as Y,T as Z,C as $,bR as p,bP as ee}from"./index-844f0276.js";import{G as te}from"./GlobalFilter-2b1c4e27.js";function ae(l){const[N,y]=n.useState("hidden"),M=n.useMemo(()=>l.columns,[]),A=n.useMemo(()=>l.dataList,[l.dataList,l==null?void 0:l.totalCount]),[i,f]=n.useState(1),[L,g]=n.useState(!0),[h,o]=n.useState(!0),[v,d]=n.useState(0);n.useEffect(()=>{f(1)},[l==null?void 0:l.totalCount]),n.useEffect(()=>{g(!0),o(!0);let a=(l==null?void 0:l.totalCount)/(l==null?void 0:l.perPage);(l==null?void 0:l.totalCount)%(l==null?void 0:l.perPage)!=0?S(parseInt(a)+1):S(parseInt(a)),u==i&&g(!1),(u==i||i==1)&&o(!1)},[l==null?void 0:l.totalCount,v]);const{getTableProps:T,getTableBodyProps:w,headerGroups:m,page:C,nextPage:b,previousPage:P,canNextPage:H,canPreviousPage:B,prepareRow:E,pageOptions:G,gotoPage:O,pageCount:I,setPageSize:S,state:x,rows:R,setGlobalFilter:W}=D.useTable({columns:M,data:A,initialState:{pageIndex:0}},D.useGlobalFilter,D.useSortBy,D.usePagination),{globalFilter:_,pageIndex:U,pageSize:u}=x;console.log("getting data => ",C);const e=()=>{u!=i&&i!=u&&(f(i+1),o(!0),console.log("clicked next true"),l.nextPage()),u==i&&(g(!1),console.log("clicked next false"))},s=()=>{u!=i&&i!=1&&(console.log("clicked prev true"),g(!0),f(i-1),l.prevPage()),(u==i||i==1)&&(console.log("clicked prev false"),o(!1))};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex mb-2 pb-2",children:[t.jsx("div",{className:"flex-initial opacity-50",children:t.jsx(te,{filter:_,setFilter:W})}),t.jsx("div",{className:"flex-initial ml-2",children:t.jsxs("button",{className:"bg-sky-400 px-3 pr-3  shadow-lg rounded py-1 text-white hover:shadow-2xl hover:bg-green-600 text-center relative",onMouseEnter:()=>y(""),onMouseLeave:()=>y("hidden"),onClick:l.exportDataF,children:["Export",t.jsx("div",{className:N+" absolute h-full top-3 text-sm left-0 text-center animate-bounce",children:t.jsx(Q,{})})]})}),t.jsx("div",{className:"flex-1",children:l.children})]}),t.jsx("div",{className:"flex w-full",children:t.jsxs("div",{className:"flex-1",children:[t.jsx("span",{className:"opacity-50",children:"Total Result : "}),t.jsx("span",{className:"font-semibold",children:l==null?void 0:l.totalCount})," "]})}),(l==null?void 0:l.feedback)!=null&&t.jsx("div",{children:t.jsxs("span",{className:"text-xs bg-gray-200 opacity-50 pr-2 pl-1 py-1 rounded-sm",children:[t.jsx(q,{className:"inline text-xs text-gray-400 mr-2"}),l.feedback]})}),t.jsx("div",{className:" py-2 overflow-x-auto bg-white",children:t.jsxs("div",{className:"inline-block min-w-full rounded-lg overflow-hidden bg-white",children:[t.jsxs("table",{...w,className:"min-w-full leading-normal",children:[t.jsx("thead",{className:"font-bold text-left text-sm bg-sky-50",children:m==null?void 0:m.map(a=>t.jsx("tr",{...a.getHeaderGroupProps(),children:a.headers.map(c=>t.jsxs("th",{...c.getHeaderProps(c.getSortByToggleProps()),className:"px-2 py-3 border-[1px] text-center border-gray-200 text-gray-800 text-xs capitalize",children:[c.render("Header"),t.jsx("span",{children:c.isSorted?c.isSortedDesc?"⬆️":"⬇️":""})]}))}))}),t.jsxs("tbody",{...w(),className:"text-sm",children:[R.map((a,c)=>{var r;return E(a),t.jsx("tr",{...a.getRowProps(),className:"bg-white shadow-lg border-[1px] border-gray-200",children:(r=a==null?void 0:a.cells)==null?void 0:r.map(j=>t.jsx("td",{...j.getCellProps(),className:"px-2 py-2 text-sm text-left border-[1px] border-gray-200",children:j.render("Cell")}))})}),t.jsx("tr",{children:t.jsx("td",{})})]})]}),t.jsxs("div",{className:"mt-3 grid grid-cols-12",children:[t.jsxs("div",{className:"col-span-2",children:["  ",t.jsx("select",{className:"h-10 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 ",value:v,onChange:a=>{d(Number(a.target.value)),l.perPageC(Number(a.target.value))},children:[5,10,25,50].map(a=>t.jsxs("option",{value:a,children:["show ",a]},a))})]}),t.jsxs("div",{className:"col-span-4 text-center col-start-5",children:["   ",t.jsxs("span",{children:["page ","",t.jsxs("strong",{children:[i," of ",u]}),""]})]}),t.jsxs("div",{className:"col-span-4 text-right",children:[t.jsx("button",{className:(h?"opacity-100":"opacity-50")+" text-xl hover:bg-sky-300 hover:text-white",onClick:()=>s(),disabled:!h,children:"⬅️"}),t.jsx("button",{className:(L?"opacity-100":"opacity-50")+" text-xl hover:bg-sky-300 hover:text-white",onClick:()=>e(),disabled:!L,children:"➡️"})]})]})]})})]})}const ie=()=>{const{get_MasterData:l,searchWardWiseCollectionSummary:N,yearList:y}=ee();J("Ward Wise Collection Summary");const[M,A]=n.useState(),[i,f]=n.useState(),[L,g]=n.useState(),[h,o]=n.useState(!1),v="form-control block w-full px-2 py-1 font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",d=X({initialValues:{fromDate:K(new Date),uptoDate:K(new Date)},onSubmit:e=>{console.log("submitting report search values => ",e),C(5),P(1),T()}}),T=e=>{o(!0);let s={fromDate:d.values.fromDate,uptoDate:d.values.uptoDate,page:b,perPage:m};console.log("data before hitting api => ",s),k.post(N,s,F()).then(a=>{var c,r,j,V,z;((c=a==null?void 0:a.data)==null?void 0:c.status)==!0?(console.log("search success => ",a),f((j=(r=a==null?void 0:a.data)==null?void 0:r.data)==null?void 0:j.items),B((z=(V=a==null?void 0:a.data)==null?void 0:V.data)==null?void 0:z.total)):console.log("error while search => ",a),o(!1),x(!1)}).catch(a=>(console.log("error while search => ",a),o(!1),x(!1)))};n.useEffect(()=>{k.get(l,F()).then(e=>{var s,a,c;((s=e==null?void 0:e.data)==null?void 0:s.status)==!0?(console.log("getting master list data => ",e),A((c=(a=e==null?void 0:e.data)==null?void 0:a.data)==null?void 0:c.ward_master)):console.log("error getting master list",e)}).catch(e=>console.log("error getting master list",e)),k.post(y,{},F()).then(e=>{var s,a;((s=e==null?void 0:e.data)==null?void 0:s.status)==!0?(console.log("year list data => ",e),g((a=e==null?void 0:e.data)==null?void 0:a.data)):console.log("error year list",e)}).catch(e=>console.log("error year list",e))},[]);const w=[{Header:"S.No.",Cell:({row:e})=>t.jsx("div",{children:(e==null?void 0:e.index)+1})},{Header:"Ward No",accessor:"ward_no",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return t.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Total Holding",accessor:"holding_no",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return t.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Current",accessor:"new_holding_no",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return t.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Arrear",accessor:"owner_name",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return t.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}},{Header:"Total",accessor:"mobile_no",Cell:e=>{if((e==null?void 0:e.value)==null||(e==null?void 0:e.value)==""||(e==null?void 0:e.value)==null)return t.jsx("i",{className:"font-semibold ",children:"N/A"});if((e==null?void 0:e.value)!=null)return e==null?void 0:e.value}}],[m,C]=n.useState(5),[b,P]=n.useState(1),[H,B]=n.useState(0),[E,G]=n.useState(),[O,I]=n.useState(!1),[S,x]=n.useState(!1),R=()=>{P(b+1)},W=()=>{P(b-1)},_=e=>{C(e)};n.useEffect(()=>{x(!0),T()},[b,m]);const U=()=>{x(!0),I(!1);let e={wardId:d.values.wardId,key:d.values.key,page:"",perPage:H};k.post(N,e,F()).then(s=>{var a,c,r;((a=s==null?void 0:s.data)==null?void 0:a.status)==!0&&(G((r=(c=s==null?void 0:s.data)==null?void 0:c.data)==null?void 0:r.items),u()),x(!1)}).catch(s=>{x(!1)})},u=()=>{I(!0)};return t.jsxs(t.Fragment,{children:[O&&t.jsx(Y,{data:E}),S&&t.jsx(Z,{}),t.jsxs("form",{onChange:d.handleChange,onSubmit:d.handleSubmit,className:"mb-4 bg-white shadow-lg rounded-md",children:[t.jsx("h1",{className:"text-xl w-full font-bold px-8 pt-4 text-gray-700",children:"Search Report"}),t.jsxs("div",{className:"flex flex-wrap flex-row justify-start w-full gap-x-6 gap-y-2 text-sm 3xl:text-base p-4 px-8",children:[t.jsxs("div",{className:"flex flex-col w-full md:w-[20%]",children:[t.jsx("div",{className:"col-span-6 font-semibold",children:"From Date :"}),t.jsx("div",{className:"col-span-6",children:t.jsx("input",{value:d.values.fromDate,type:"date",name:"fromDate",id:"",className:v,disabled:h})})]}),t.jsxs("div",{className:"flex flex-col w-full md:w-[20%]",children:[t.jsx("div",{className:"col-span-6 font-semibold",children:"Upto Date :"}),t.jsx("div",{className:"col-span-6",children:t.jsx("input",{value:d.values.uptoDate,type:"date",name:"uptoDate",id:"",className:v,disabled:h})})]}),t.jsx("div",{className:"w-full md:w-[20%] flex justify-start items-end",children:h?t.jsx(t.Fragment,{children:t.jsx("div",{className:"flex justify-end",children:t.jsx($,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})})}):t.jsxs("button",{type:"submit",className:"flex flex-row items-center border border-green-600 bg-green-600 hover:bg-green-500 text-white hover:text-black shadow-lg rounded-sm text-sm font-semibold px-5 py-1 w-max",children:[" ",t.jsx("span",{className:"mr-2",children:t.jsx(p,{})}),"Search"]})})]})]}),i!=null&&(i==null?void 0:i.length)!=0?t.jsx(t.Fragment,{children:t.jsx(ae,{columns:w,dataList:i,exportStatus:!0,perPage:m,perPageC:_,totalCount:H,nextPage:R,prevPage:W,exportDataF:U})}):t.jsx(t.Fragment,{children:t.jsx("div",{className:"w-full my-4 text-center text-red-500 text-lg font-bold",children:"No Data Found"})}),t.jsx("div",{className:"h-[20vh]"})]})};export{ie as default};
