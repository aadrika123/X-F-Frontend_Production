import{r,j as b}from"./index-3617a985.js";import{$ as it}from"./index-9b36cb1b.js";function ct(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function lt(s){return s?typeof s.selectionStart=="number"&&typeof s.selectionEnd=="number"?{start:s.selectionStart,end:s.selectionEnd}:{start:0,end:0}:{start:0,end:0}}function dt(s,a){s&&(s.selectionStart?(s.focus(),s.setSelectionRange(a,a)):s.focus())}const x={KEY_RETURN:"Enter",KEY_ENTER:"Enter",KEY_TAB:"Tab",KEY_SPACE:" "},j="https://xlit-api.ai4bharat.org/",ut=async(s,a)=>{const{showCurrentWordAsLastSuggestion:d,lang:f}=a||{numOptions:5,showCurrentWordAsLastSuggestion:!0,lang:"hi"},c={method:"GET"};try{const l=await(await fetch(j+`tl/${f}/${s==="."||s===".."?" "+s.replace(".","%2E"):encodeURIComponent(s).replace(".","%2E")}`,c)).json();return console.log("library data",l),l&&l.result.length>0?d?[...l.result,s]:l.result:d?[s]:[]}catch(h){return console.error("There was an error with transliteration",h),[]}},ft=async()=>{if(sessionStorage.getItem("indic_transliterate__supported_languages"))return JSON.parse(sessionStorage.getItem("indic_transliterate__supported_languages")||"");{const s=`${j}languages`;new Headers().append("Content-Type","application/json");const d={method:"GET"};try{const c=await(await fetch(s,d)).json();return sessionStorage.setItem("indic_transliterate__supported_languages",JSON.stringify(c)),c}catch(f){return console.error("There was an error with transliteration",f),[]}}},pt="ArrowUp",ht="ArrowDown",gt="Escape",$t=10,St=100,bt=({renderComponent:s=i=>b.jsx("input",{...i}),lang:a="hi",offsetX:d=0,offsetY:f=10,onChange:c,onChangeText:h,onBlur:l,value:y,onKeyDown:g,containerClassName:D="",containerStyles:M={},activeItemStyles:Et={},maxOptions:O=5,hideSuggestionBoxOnMobileDevices:C=!1,hideSuggestionBoxBreakpoint:I=450,triggerKeys:P=[x.KEY_SPACE,x.KEY_ENTER,x.KEY_RETURN,x.KEY_TAB],insertCurrentSelectionOnBlur:z=!0,showCurrentWordAsLastSuggestion:R=!0,enabled:B=!0,...H})=>{const[i,k]=r.useState([]),[U,F]=r.useState(0),[G,q]=r.useState(0),[p,$]=r.useState(0),[v,V]=r.useState(-1),[J,X]=r.useState(-1),S=r.useRef(null),[A,L]=r.useState({width:0,height:0}),[Q,Z]=r.useState("ltr"),[E,Y]=r.useState(null),_=r.useMemo(()=>C?A.width>I:!0,[A,I,C]),w=()=>{$(0),k([])},T=(t,e=" ")=>{var n;const o=y,u=o.substring(0,v)+i[t]+" "+o.substring(J+1,o.length);setTimeout(()=>{dt(S.current,e==="Enter"?v+i[t].length:v+i[t].length+1)},1);const m={target:{value:u}};return h(u),c&&c(m),w(),(n=S.current)===null||n===void 0?void 0:n.focus()},tt=async t=>{if(!_)return;const e=R?O-1:O,n=await ut(t,{numOptions:e,showCurrentWordAsLastSuggestion:R,lang:a});k(n??[])},et=async t=>{const e=await ft(),n=e==null?void 0:e.find(u=>u.LangCode===t);var o;return[(o=n==null?void 0:n.Direction)!==null&&o!==void 0?o:"ltr",n==null?void 0:n.GoogleFont,n==null?void 0:n.FallbackFont]},nt=t=>{const e=t.currentTarget.value;if(c&&c(t),h(e),!_)return;const n=lt(t.target).end,o=S.current;if(!o)return;const u=it(o,n),m=e.lastIndexOf(" ",n-1)<e.lastIndexOf(`
`,n-1)?e.lastIndexOf(`
`,n-1):e.lastIndexOf(" ",n-1);V(m+1),X(n-1);const N=e.slice(m+1,n);if(N&&B){tt(N);const W=o.getBoundingClientRect(),rt=Math.min(u.left,W.width-St/2),at=Math.min(u.top+$t,W.height);q(at),F(rt)}else w()},st=t=>{if(i.length>0)if(P.includes(t.key))t.preventDefault(),T(p,t.key);else switch(t.key){case gt:t.preventDefault(),w();break;case pt:t.preventDefault(),$((i.length+p-1)%i.length);break;case ht:t.preventDefault(),$((p+1)%i.length);break;default:g&&g(t);break}else g&&g(t)},ot=t=>{ct()||(z&&i[p]?T(p):w()),l&&l(t)},K=()=>{const t=window.innerWidth,e=window.innerHeight;L({width:t,height:e})};return r.useEffect(()=>{window.addEventListener("resize",K);const t=window.innerWidth,e=window.innerHeight;return L({width:t,height:e}),()=>{window.removeEventListener("resize",K)}},[]),r.useEffect(()=>{et(a).then(([t,e,n])=>{if(Z(t),e){if(!document.getElementById(`font-${e}`)){const o=document.createElement("link");o.id=`font-${e}`,o.href=`https://fonts.googleapis.com/css?family=${e}`,o.rel="stylesheet",document.head.appendChild(o)}Y(`${e}, ${n??"sans-serif"}`)}else Y(null)})},[a]),b.jsxs("div",{style:{...M,position:"relative"},className:D,children:[s({onChange:nt,onKeyDown:st,onBlur:ot,ref:S,value:y,"data-testid":"rt-input-component",lang:a,style:{direction:Q,...E&&{fontFamily:E}},...H}),_&&i.length>0&&b.jsx("ul",{style:{backgroundClip:"padding-box",backgroundColor:"#fff",border:"1px solid rgba(0, 0, 0, 0.15)",boxShadow:"0 6px 12px rgba(0, 0, 0, 0.175)",display:"block",fontSize:"14px",listStyle:"none",padding:"1px",textAlign:"left",zIndex:2e4,left:`${U+d}px`,top:`${G+f}px`,position:"absolute",width:"auto",...E&&{fontFamily:E}},"data-testid":"rt-suggestions-list",lang:a,children:Array.from(new Set(i)).map((t,e)=>b.jsx("li",{style:e===p?{cursor:"pointer",padding:"10px",minWidth:"100px",backgroundColor:"#65c3d7",color:"#fff"}:{cursor:"pointer",padding:"10px",minWidth:"100px",backgroundColor:"#fff"},onMouseEnter:()=>{$(e)},onClick:()=>T(e),children:t},t))})]})};export{bt as $};
