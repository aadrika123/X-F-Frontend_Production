import{aN as H,a as W,r as c,j as e,M as J,bS as K,c2 as Q,t as X,u as Z,g as ee,aO as se,A as u,c as ae,d as M,b as te,b_ as m,o as re,aD as L,bN as oe}from"./index-a511550f.js";const ne={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",background:"transparent",border:"none"}};function le(t){const[a,g]=H.useState(!1),l=t==null?void 0:t.transData,d=W(),x=t.paymentData;console.log("paymentData======",x),c.useEffect(()=>{g(!0)},[]);function y(){}function r(){g(!1)}return e.jsx("div",{className:"",children:e.jsx(J,{isOpen:a,onAfterOpen:y,onRequestClose:r,style:ne,contentLabel:"Example Modal",children:e.jsx("div",{children:e.jsxs("div",{className:"bg-green-200 shadow-2xl border border-sky-200 p-5 m-5 rounded-md",children:[e.jsxs("div",{onClick:r,className:"absolute cursor-pointer bg-green-100 hover:bg-gray-300 p-1 rounded-md",children:[e.jsx(K,{})," "]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:Q,className:"h-20",alt:"",srcset:""})}),e.jsx("div",{className:"py-1 pl-3 font-semibold text-center text-2xl text-gray-800",children:" Payment Completed Successfully "}),e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"text-base",children:" Payment Transaction No"})," ",e.jsx("span",{className:"font-bold text-blue-700 text-xl",children:l==null?void 0:l.transectionNo})]}),e.jsx("p",{className:"border-b border-gray-300 mx-10 py-1"}),e.jsxs("div",{className:"grid grid-cols-12 px-8 py-3 leading-8 space-x-8 text-sm",children:[e.jsx("div",{className:"md:col-span-6 col-span-12",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"col-span-6 font-semibold",children:[e.jsx("p",{children:"Application No"}),e.jsx("p",{children:"Connection Type"})]}),e.jsxs("div",{className:"col-span-6 ml-3",children:[e.jsx("p",{children:l==null?void 0:l.applicationNo}),e.jsx("p",{children:l==null?void 0:l.tranType})]})]})}),e.jsx("div",{className:"md:col-span-6 col-span-12",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"col-span-6 font-semibold",children:[e.jsx("p",{children:"Amount"}),e.jsx("p",{children:"Payment Date"})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("p",{children:l==null?void 0:l.amount}),e.jsx("p",{children:l==null?void 0:l.transectionDate})]})]})}),e.jsx("div",{className:"col-span-12 md:mt-4 mt-10",children:e.jsxs("div",{className:"flex justify-center",children:[e.jsx("button",{onClick:r,className:"mx-2 bg-sky-600 hover:bg-sky-700 transition duration-200 hover:scale-105 font-normal text-white px-6 py-1 text-sm rounded-sm shadow-xl",children:"Close"}),l&&e.jsx("button",{onClick:()=>d(`/waterUserReceipt/${l==null?void 0:l.transectionNo}`),className:"mx-2 bg-indigo-600 hover:bg-indigo-700 transition duration-200 hover:scale-105 font-normal text-white px-4 py-2 text-sm  rounded-sm shadow-xl",children:"View Receipt"})]})})]})]})})})})}const ce=()=>{var I,_,A;const{t}=X(),[a,g]=c.useState(),[l,d]=c.useState(!1),[x,y]=c.useState(),[r,j]=c.useState(),[b,k]=c.useState(),[f,D]=c.useState(),[S,Y]=c.useState(!1),[P,U]=c.useState(),{id:h}=Z(),E=W(),{notify:v}=c.useContext(ee),{api_getTranNo:O,api_waterApprovedApplicationDetails:R,api_waterListDemand:T,api_waterDemandCalculation:q,api_waterDemandPayment:z,header:p}=se();c.useEffect(()=>{V(),w()},[h]),c.useEffect(()=>{G()},[f,b]);const G=()=>{if(f==""||b=="")return j();d(!0);const s={consumerId:h,demandFrom:b,demandUpto:f};u.post(q,s,p).then(function(n){console.log("water demand calculation Details",n.data.data),j(n.data.data),d(!1)}).catch(function(n){console.log("Error : water calculating demand",n),d(!1)})},V=()=>{d(!0),u.post(R,{id:h},p).then(function(s){console.log("water Approved Application Details",s.data.data),g(s.data.data),d(!1)}).catch(function(s){console.log("Error : water Approved Application Details",s),d(!1)})},w=()=>{u.post(T,{ConsumerId:h},p).then(s=>{console.log("Fetched Water Demand List",s.data.data),y(s.data.data)}).catch(s=>{console.log("Exception while fetching Water Demand",s)})},C=s=>{if(console.log("Payment Status =>",s),s.status==!0){v("Payment Done successfully","success"),Y(!0);const n={orderId:s.data.razorpay_order_id,paymentId:s.data.razorpay_payment_id};u.post(O,n,p).then(i=>{console.log("Data after payment success by OrderId and PaymentID",i),i.data.status==!0&&U(i.data.data)}).catch(i=>console.log("Exception/Error while fetching by OrderID and Payment ID",i))}w()},$=()=>{d(!0);const s={consumerId:h,demandFrom:b,demandUpto:f,amount:r==null?void 0:r.totalPayAmount,paymentMode:"online",remarks:"citizen payment"};console.log("final submit",s),u.post(z,s,p).then(n=>{n.data.status?(d(!1),console.log("Order Id Generated Successfully",n),n.data.status==!0?oe(n.data.data,C):v(n.data.message,"error")):(console.log("Failed Generate Order ID.",n),d(!1))}).catch(n=>{console.log("Exception while generating order id",n),d(!1)})},B=ae({monthFrom:M().required("Require Field"),monthUpto:M().required("Require Field")}),o=te({enableReinitialize:!0,initialValues:{monthFrom:"",monthUpto:"",penalty:"",rebate:"",advanced:""},onSubmit:(s,n)=>{$()},validationSchema:B}),F=s=>{let n=s.target.name,i=s.target.value;n=="monthFrom"&&k(i),n=="monthUpto"&&D(i)},N=(I=x==null?void 0:x.consumerDemands)==null?void 0:I.filter(s=>m(s.demand_upto,"YYYY-MM-DD").format("yy-MM").toString()>=m(b,"YYYY-MM-DD").format("yy-MM"));return e.jsxs(e.Fragment,{children:[l&&e.jsx(re,{}),S&&e.jsx(le,{transData:P}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 gap-2 container mx-auto w-full",children:e.jsxs("div",{className:"col-span-12 rounded-lg p-4",children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"",children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif  text-gray-500",children:[e.jsx(L,{className:"inline"})," ",t("tranWaterDashboardIndex.basicDetailsLabel.label")]}),e.jsx("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl p-4",children:e.jsxs("div",{className:"flex space-x-5 pl-4 ",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-sm",children:a!=null&&a.ulb_name?a==null?void 0:a.ulb_name:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:t("tranWaterDashboardIndex.ulbNameLabel.label")})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:a!=null&&a.ward_name?a==null?void 0:a.ward_name:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:t("tranWaterDashboardIndex.wardNoLabel.label")})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:a!=null&&a.consumer_no?a==null?void 0:a.consumer_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:t("tranWaterDashboardIndex.consumerNoLabel.label")})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:a!=null&&a.connection_through?a==null?void 0:a.connection_through:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:t("tranWaterDashboardIndex.connectionThroughLabel.label")})]}),(a==null?void 0:a.connection_through)=="SAF"?e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:a!=null&&a.saf_no?a==null?void 0:a.saf_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:t("tranWaterDashboardIndex.safNoLabel.label")})]}):e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:a!=null&&a.holding_no?a==null?void 0:a.holding_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:t("tranWaterDashboardIndex.holdingNoLabel.label")})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:a!=null&&a.owner_char_type?a==null?void 0:a.owner_char_type:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:t("tranWaterDashboardIndex.ownershipTypeLabel.label")})]})]})})]})}),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-5 p-4",children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif text-gray-500",children:[e.jsx(L,{className:"inline"}),t("tranWaterDashboardIndex.dueDemandDetailsLabel.label")]}),e.jsxs("table",{className:"min-w-full leading-normal mt-2 bg-white rounded-lg shadow-xl p-4",children:[e.jsx("thead",{className:"font-bold text-left text-sm border text-gray-800 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"#"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:t("tranWaterDashboardIndex.demandFromLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:t("tranWaterDashboardIndex.demandUptoLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:t("tranWaterDashboardIndex.demandAmountLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:t("tranWaterDashboardIndex.penaltyLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:t("tranWaterDashboardIndex.connectionTypeLabel.label")}),e.jsxs("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:[t("tranWaterDashboardIndex.payableAmountLabel.label")," "]})]})}),e.jsx("tbody",{className:"text-sm",children:e.jsx(e.Fragment,{children:(_=x==null?void 0:x.consumerDemands)==null?void 0:_.map((s,n)=>e.jsxs("tr",{className:"bg-white shadow-xl border-b border-gray-200",children:[e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:n+1}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.demand_from?m(s==null?void 0:s.demand_from,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.demand_upto?m(s==null?void 0:s.demand_upto,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.balance_amount?s==null?void 0:s.balance_amount:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.penalty?s==null?void 0:s.penalty:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.connection_type?s==null?void 0:s.connection_type:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s!=null&&s.amount?"₹ "+(s==null?void 0:s.amount):"N/A"})]}))})})]})]})}),e.jsx("div",{className:"col-span-12 rounded-lg p-4",children:e.jsx("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl border border-y-gray-200 p-4",children:e.jsx("form",{onSubmit:o.handleSubmit,onChange:F,className:"p-4 relative",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),t("tranWaterDashboardIndex.selectMonthFromLabel.label")]}),e.jsxs("select",{...o.getFieldProps("monthFrom"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",children:t("tranWaterDashboardIndex.selectUlbOptionLabel.label")}),(A=x==null?void 0:x.consumerDemands)==null?void 0:A.map((s,n)=>e.jsx("option",{value:s.demand_from,children:m(s.demand_from,"YYYY-MM-DD").format("MMM-yy")},n))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.monthFrom&&o.errors.monthFrom?o.errors.monthFrom:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),t("tranWaterDashboardIndex.selectMonthUptoLabel.label")]}),e.jsxs("select",{...o.getFieldProps("monthUpto"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",children:t("tranWaterDashboardIndex.selectUlbOptionLabel.label")}),N==null?void 0:N.map((s,n)=>e.jsx("option",{value:s.demand_upto,children:m(s.demand_upto,"YYYY-MM-DD").format("MMM-yy")},n))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.monthUpto&&o.errors.monthUpto?o.errors.monthUpto:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:t("tranWaterDashboardIndex.totalDemandLabel.label")}),e.jsx("input",{...o.getFieldProps("amount"),value:(r==null?void 0:r.totalDemand)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.amount&&o.errors.amount?o.errors.amount:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:t("tranWaterDashboardIndex.penaltyLabel.label")}),e.jsx("input",{...o.getFieldProps("penalty"),value:(r==null?void 0:r.totalPenalty)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.penalty&&o.errors.penalty?o.errors.penalty:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:t("tranWaterDashboardIndex.rebateLabel.label")}),e.jsx("input",{...o.getFieldProps("rebate"),value:(r==null?void 0:r.totalRebate)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.rebate&&o.errors.rebate?o.errors.rebate:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:t("tranWaterDashboardIndex.advancedLabel.label")}),e.jsx("input",{...o.getFieldProps("advanced"),value:(r==null?void 0:r.totalAdvance)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.advanced&&o.errors.advanced?o.errors.advanced:null})]}),e.jsx("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:e.jsxs("p",{children:[t("tranWaterDashboardIndex.remainAdvanceLabel.label"),": ",e.jsx("span",{className:"text-orange-700 font-semibold",children:(r==null?void 0:r.remaningAdvanceAmount)||0})]})}),e.jsx("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:e.jsxs("p",{children:["  ",t("tranWaterDashboardIndex.payableAmountLabel.label"),": ",e.jsx("span",{className:"text-green-700 font-semibold",children:r!=null&&r.totalPayAmount?"₹"+(r==null?void 0:r.totalPayAmount):0})]})}),e.jsxs("div",{className:"col-span-12 grid grid-cols-2 mt-10",children:[e.jsx("div",{className:""}),e.jsxs("div",{className:"md:pl-10 text-right space-x-5",children:[e.jsx("button",{type:"button",onClick:()=>E(-1),className:" px-6 py-2.5 bg-sky-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-sky-700 hover:shadow-lg focus:bg-sky-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:t("tranWaterDashboardIndex.backLabel.label")}),e.jsx("button",{type:"submit",className:" px-6 py-2.5 bg-indigo-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-indigo-600 hover:shadow-lg focus:bg-indigo-700 focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:t("tranWaterDashboardIndex.payTaxLabel.label")})]})]})]})})})})]})})]})};export{ce as default};
