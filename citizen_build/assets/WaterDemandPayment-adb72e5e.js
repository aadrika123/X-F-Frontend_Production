import{b3 as K,a as _,r as c,j as e,M as H,cC as J,cD as Q,w as X,u as Z,h as ee,b4 as ae,A as u,c as se,d as A,b as te,bp as m,q as re,aK as L,cE as oe}from"./index-f28bac82.js";const ne={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",background:"transparent",border:"none"}};function le(s){const[r,g]=K.useState(!1),l=s==null?void 0:s.transData,d=_(),i=s.paymentData;console.log("paymentData======",i),c.useEffect(()=>{g(!0)},[]);function y(){}function t(){g(!1)}return e.jsx("div",{className:"",children:e.jsx(H,{isOpen:r,onAfterOpen:y,onRequestClose:t,style:ne,contentLabel:"Example Modal",children:e.jsx("div",{children:e.jsxs("div",{className:"bg-green-200 shadow-2xl border border-sky-200 p-5 m-5 rounded-md",children:[e.jsxs("div",{onClick:t,className:"absolute cursor-pointer bg-green-100 hover:bg-gray-300 p-1 rounded-md",children:[e.jsx(J,{})," "]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:Q,className:"h-20",alt:"",srcset:""})}),e.jsx("div",{className:"py-1 pl-3 font-semibold text-center text-2xl text-gray-800",children:" Payment Completed Successfully "}),e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"text-base",children:" Payment Transaction No"})," ",e.jsx("span",{className:"font-bold text-blue-700 text-xl",children:l==null?void 0:l.transectionNo})]}),e.jsx("p",{className:"border-b border-gray-300 mx-10 py-1"}),e.jsxs("div",{className:"grid grid-cols-12 px-8 py-3 leading-8 space-x-8 text-sm",children:[e.jsx("div",{className:"md:col-span-6 col-span-12",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"col-span-6 font-semibold",children:[e.jsx("p",{children:"Application No"}),e.jsx("p",{children:"Connection Type"})]}),e.jsxs("div",{className:"col-span-6 ml-3",children:[e.jsx("p",{children:l==null?void 0:l.applicationNo}),e.jsx("p",{children:l==null?void 0:l.tranType})]})]})}),e.jsx("div",{className:"md:col-span-6 col-span-12",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"col-span-6 font-semibold",children:[e.jsx("p",{children:"Amount"}),e.jsx("p",{children:"Payment Date"})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("p",{children:l==null?void 0:l.amount}),e.jsx("p",{children:l==null?void 0:l.transectionDate})]})]})}),e.jsx("div",{className:"col-span-12 md:mt-4 mt-10",children:e.jsxs("div",{className:"flex justify-center",children:[e.jsx("button",{onClick:t,className:"mx-2 bg-sky-600 hover:bg-sky-700 transition duration-200 hover:scale-105 font-normal text-white px-6 py-1 text-sm rounded-sm shadow-xl",children:"Close"}),l&&e.jsx("button",{onClick:()=>d(`/waterUserReceipt/${l==null?void 0:l.transectionNo}`),className:"mx-2 bg-indigo-600 hover:bg-indigo-700 transition duration-200 hover:scale-105 font-normal text-white px-4 py-2 text-sm  rounded-sm shadow-xl",children:"View Receipt"})]})})]})]})})})})}const ce=()=>{var D,I,M;const{t:s}=X(),[r,g]=c.useState(),[l,d]=c.useState(!1),[i,y]=c.useState(),[t,j]=c.useState(),[b,k]=c.useState(),[f,W]=c.useState(),[P,Y]=c.useState(!1),[S,U]=c.useState(),{id:p}=Z(),F=_(),{notify:v}=c.useContext(ee),{api_getTranNo:E,api_waterApprovedApplicationDetails:O,api_waterListDemand:R,api_waterDemandCalculation:T,api_waterDemandPayment:q,header:h}=ae();c.useEffect(()=>{C(),w()},[p]),c.useEffect(()=>{z()},[f,b]);const z=()=>{if(f==""||b=="")return j();d(!0);const a={consumerId:p,demandFrom:b,demandUpto:f};u.post(T,a,h).then(function(n){console.log("water demand calculation Details",n.data.data),j(n.data.data),d(!1)}).catch(function(n){console.log("Error : water calculating demand",n),d(!1)})},C=()=>{d(!0),u.post(O,{id:p},h).then(function(a){console.log("water Approved Application Details",a.data.data),g(a.data.data),d(!1)}).catch(function(a){console.log("Error : water Approved Application Details",a),d(!1)})},w=()=>{u.post(R,{ConsumerId:p},h).then(a=>{console.log("Fetched Water Demand List",a.data.data),y(a.data.data)}).catch(a=>{console.log("Exception while fetching Water Demand",a)})},G=a=>{if(console.log("Payment Status =>",a),a.status==!0){v("Payment Done successfully","success"),Y(!0);const n={orderId:a.data.razorpay_order_id,paymentId:a.data.razorpay_payment_id};u.post(E,n,h).then(x=>{console.log("Data after payment success by OrderId and PaymentID",x),x.data.status==!0&&U(x.data.data)}).catch(x=>console.log("Exception/Error while fetching by OrderID and Payment ID",x))}w()},V=()=>{d(!0);const a={consumerId:p,demandFrom:b,demandUpto:f,amount:t==null?void 0:t.totalPayAmount,paymentMode:"online",remarks:"citizen payment"};console.log("final submit",a),u.post(q,a,h).then(n=>{n.data.status?(d(!1),console.log("Order Id Generated Successfully",n),n.data.status==!0?oe(n.data.data,G):v(n.data.message,"error")):(console.log("Failed Generate Order ID.",n),d(!1))}).catch(n=>{console.log("Exception while generating order id",n),d(!1)})},$=se({monthFrom:A().required("Require Field"),monthUpto:A().required("Require Field")}),o=te({enableReinitialize:!0,initialValues:{monthFrom:"",monthUpto:"",penalty:"",rebate:"",advanced:""},onSubmit:(a,n)=>{V()},validationSchema:$}),B=a=>{let n=a.target.name,x=a.target.value;n=="monthFrom"&&k(x),n=="monthUpto"&&W(x)},N=(D=i==null?void 0:i.consumerDemands)==null?void 0:D.filter(a=>m(a.demand_upto,"YYYY-MM-DD").format("yy-MM").toString()>=m(b,"YYYY-MM-DD").format("yy-MM"));return e.jsxs(e.Fragment,{children:[l&&e.jsx(re,{}),P&&e.jsx(le,{transData:S}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 gap-2 container mx-auto w-full",children:e.jsxs("div",{className:"col-span-12 rounded-lg p-4",children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"",children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif  text-gray-500",children:[e.jsx(L,{className:"inline"})," ",s("tranWaterDashboardIndex.basicDetailsLabel.label")]}),e.jsx("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl p-4",children:e.jsxs("div",{className:"flex space-x-5 pl-4 ",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-sm",children:r!=null&&r.ulb_name?r==null?void 0:r.ulb_name:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:s("tranWaterDashboardIndex.ulbNameLabel.label")})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:r!=null&&r.ward_name?r==null?void 0:r.ward_name:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:s("tranWaterDashboardIndex.wardNoLabel.label")})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-sm",children:r!=null&&r.consumer_no?r==null?void 0:r.consumer_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:s("tranWaterDashboardIndex.consumerNoLabel.label")})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-md",children:r!=null&&r.property_no?r==null?void 0:r.property_no:"N/A"}),e.jsx("div",{className:"text-gray-500 text-xs",children:s("tranWaterDashboardIndex.holdingNoLabel.label")})]})]})})]})}),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-5 p-4",children:[e.jsxs("h1",{className:"px-1 font-semibold font-serif text-gray-500",children:[e.jsx(L,{className:"inline"}),s("tranWaterDashboardIndex.dueDemandDetailsLabel.label")]}),e.jsxs("table",{className:"min-w-full leading-normal mt-2 bg-white rounded-lg shadow-xl p-4",children:[e.jsx("thead",{className:"font-bold text-left text-sm border text-gray-800 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"#"}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:s("tranWaterDashboardIndex.demandFromLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:s("tranWaterDashboardIndex.demandUptoLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:s("tranWaterDashboardIndex.demandAmountLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:s("tranWaterDashboardIndex.penaltyLabel.label")}),e.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:s("tranWaterDashboardIndex.connectionTypeLabel.label")}),e.jsxs("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:[s("tranWaterDashboardIndex.payableAmountLabel.label")," "]})]})}),e.jsx("tbody",{className:"text-sm",children:e.jsx(e.Fragment,{children:(I=i==null?void 0:i.consumerDemands)==null?void 0:I.map((a,n)=>e.jsxs("tr",{className:"bg-white shadow-xl border-b border-gray-200",children:[e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:n+1}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:a!=null&&a.demand_from?m(a==null?void 0:a.demand_from,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:a!=null&&a.demand_upto?m(a==null?void 0:a.demand_upto,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:a!=null&&a.balance_amount?a==null?void 0:a.balance_amount:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:a!=null&&a.penalty?a==null?void 0:a.penalty:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:a!=null&&a.connection_type?a==null?void 0:a.connection_type:"N/A"}),e.jsx("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:a!=null&&a.amount?"â‚¹ "+(a==null?void 0:a.amount):"N/A"})]}))})})]})]})}),e.jsx("div",{className:"col-span-12 rounded-lg p-4",children:e.jsx("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl border border-y-gray-200 p-4",children:e.jsx("form",{onSubmit:o.handleSubmit,onChange:B,className:"p-4 relative",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),s("tranWaterDashboardIndex.selectMonthFromLabel.label")]}),e.jsxs("select",{...o.getFieldProps("monthFrom"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",children:s("tranWaterDashboardIndex.selectUlbOptionLabel.label")}),(M=i==null?void 0:i.consumerDemands)==null?void 0:M.map((a,n)=>e.jsx("option",{value:a.demand_from,children:m(a.demand_from,"YYYY-MM-DD").format("MMM-yy")},n))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.monthFrom&&o.errors.monthFrom?o.errors.monthFrom:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),s("tranWaterDashboardIndex.selectMonthUptoLabel.label")]}),e.jsxs("select",{...o.getFieldProps("monthUpto"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",children:s("tranWaterDashboardIndex.selectUlbOptionLabel.label")}),N==null?void 0:N.map((a,n)=>e.jsx("option",{value:a.demand_upto,children:m(a.demand_upto,"YYYY-MM-DD").format("MMM-yy")},n))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.monthUpto&&o.errors.monthUpto?o.errors.monthUpto:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:s("tranWaterDashboardIndex.totalDemandLabel.label")}),e.jsx("input",{...o.getFieldProps("amount"),value:(t==null?void 0:t.totalDemand)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.amount&&o.errors.amount?o.errors.amount:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:s("tranWaterDashboardIndex.penaltyLabel.label")}),e.jsx("input",{...o.getFieldProps("penalty"),value:(t==null?void 0:t.totalPenalty)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.penalty&&o.errors.penalty?o.errors.penalty:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:s("tranWaterDashboardIndex.rebateLabel.label")}),e.jsx("input",{...o.getFieldProps("rebate"),value:(t==null?void 0:t.totalRebate)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.rebate&&o.errors.rebate?o.errors.rebate:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:s("tranWaterDashboardIndex.advancedLabel.label")}),e.jsx("input",{...o.getFieldProps("advanced"),value:(t==null?void 0:t.totalAdvance)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.advanced&&o.errors.advanced?o.errors.advanced:null})]}),e.jsx("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:e.jsxs("p",{children:[s("tranWaterDashboardIndex.remainAdvanceLabel.label"),": ",e.jsx("span",{className:"text-orange-700 font-semibold",children:(t==null?void 0:t.remaningAdvanceAmount)||0})]})}),e.jsx("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:e.jsxs("p",{children:["  ",s("tranWaterDashboardIndex.payableAmountLabel.label"),": ",e.jsx("span",{className:"text-green-700 font-semibold",children:t!=null&&t.totalPayAmount?"â‚¹"+(t==null?void 0:t.totalPayAmount):0})]})}),e.jsxs("div",{className:"col-span-12 grid grid-cols-2 mt-10",children:[e.jsx("div",{className:""}),e.jsxs("div",{className:"md:pl-10 text-right space-x-5",children:[e.jsx("button",{type:"button",onClick:()=>F(-1),className:" px-6 py-2.5 bg-sky-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-sky-700 hover:shadow-lg focus:bg-sky-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:s("tranWaterDashboardIndex.backLabel.label")}),e.jsx("button",{type:"submit",className:" px-6 py-2.5 bg-indigo-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-indigo-600 hover:shadow-lg focus:bg-indigo-700 focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:"Online Payment Comming Soon"})]})]})]})})})})]})})]})};export{ce as default};
