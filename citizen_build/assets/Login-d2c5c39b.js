import{g as U,B as Y,r as a,h as H,a as W,c as Z,d as M,b as G,j as e,i as J,S as K,O as Q,R as X,k as ee,l as te,m as se,n as oe,f as ae}from"./index-1c257416.js";import{l as le}from"./login-341c8dbe.js";import re from"./MobileNoCard-da6a0f0f.js";const me=()=>{const c=U();console.log("backend url imported....",Y);const[u,r]=a.useState(!1),[P,m]=a.useState(!1),[E,x]=a.useState(!1),{api_citizenLogin2:z}=ae(),[g,B]=a.useState(null),{notify:i,setheartBeatCounter:_}=a.useContext(H),l=W(),[A,p]=a.useState();a.useState(!0),a.useEffect(()=>{window.localStorage.getItem("citizen_token")},[]);const T=Z().shape({mobile:M().required("Enter mobile no. !").min(10).max(10),password:M().min(6,"Minimum six character !").max(50,"Too Long!").required("Enter password no. !").matches(/^(?=.*\d)(?=.*[!@#$%^&*])(?=.*[a-z])(?=.*[A-Z]).{6,}$/,"Password Must Contains (Capital, Smail, Number, Special) eg - Abc123#.")}),o=G({initialValues:{mobile:"",password:""},onSubmit:s=>{console.log("post data",s),D(s)},validationSchema:T}),D=s=>{let n=!1;p(""),r(!0),h(!1),se.post(z,{mobile:s==null?void 0:s.mobile,password:s==null?void 0:s.password}).then(t=>{var f,w,j,y,N,S,v,C,k,L,F;console.log("response after login....",t==null?void 0:t.data),((f=t==null?void 0:t.data)==null?void 0:f.status)===!0?(localStorage.setItem("citizen_token",(j=(w=t==null?void 0:t.data)==null?void 0:w.data)==null?void 0:j.token),r(!1),localStorage.setItem("propertyPopup",!0),localStorage.setItem("advertPopup",!0),localStorage.setItem("device","web"),i("Login Success","success"),window.localStorage.setItem("citizenMobile",(N=(y=t==null?void 0:t.data)==null?void 0:y.data)==null?void 0:N.mobile),window.localStorage.setItem("citizenName",(v=(S=t==null?void 0:t.data)==null?void 0:S.data)==null?void 0:v.userName),_(b=>b+1),(C=c==null?void 0:c.mainMenu)==null||C.map(b=>{var I;return(I=b.subMenu)==null?void 0:I.map(d=>{d.id==localStorage.getItem("cardMenu")&&(l(d==null?void 0:d.route),n=!0)})}),n||l("/landingDashboard")):(console.log("Login Failed",(k=t==null?void 0:t.data)==null?void 0:k.message),i((L=t==null?void 0:t.data)==null?void 0:L.message,"error"),r(!1)),console.log("=== Invalid Details",t),p((F=t==null?void 0:t.data)==null?void 0:F.message)}).catch(t=>{console.log(t),console.log("-Exception--",t),r(!1),p("something went wrongg"),h(!0),i("something went wrongg !!","error")})},O=s=>{let n=s.target.name,t=s.target.value;n=="mobile"&&o.setFieldValue("mobile",oe(t,o.values.mobile,10))},R=()=>{i("Mobile no. has been verified successfully !","success"),l(`/change-password/forgot/${g}`)},V=()=>{m(!1)},$=()=>{x(!1)},[q,h]=a.useState(!1);return q?e.jsx(J,{children:e.jsx(K,{title:"Server is busy",desc:"Server is too busy to respond. Please try again later.",buttonText:"View Dashboard",buttonUrl:"/propertyDashboard"})}):P?e.jsx(re,{cardFor:"Login",closeMobileModal:V,headTitle:"Forgot Password",title:"Enter mobile to get OTP",desc:"Enter your mobile no, which is attached to your account.",setverifedMobileNo:B,setmobileCardStatus:m,setotpCardStatus:x}):E?e.jsx(Q,{verifedMobileNo:g,closeOtpModal:$,bottomNaviation:!0,headTitle:"Forgot OTP",callback:R,setotpCardStatus:x}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-full h-[90vh] flex items-center justify-center text-center p-4 md:p-0 mx-auto bg-white md:bg-none shadow-lg md:shadow-none",children:e.jsx("div",{className:"w-full md:w-3/5 mx-auto mt-16 rouned-lg ",children:e.jsx("form",{onChange:O,onSubmit:o.handleSubmit,children:e.jsxs("div",{className:"grid grid-cols-12 px-2 md:px-0 shadow-none md:shadow-lg ",children:[e.jsx("div",{className:"col-span-6 hidden md:block bg-white md:py-10",children:e.jsx("img",{className:"w-3/4",src:le})}),e.jsx("div",{className:"w-full md:px-10 col-span-12 md:col-span-6 md:shadow-none bg-white py-10",children:e.jsxs("div",{className:"w-full  pb-6 pt-0 md:py-6 md:mt-10 text-gray-700",children:[e.jsx("h1",{className:"text-center text-md font-semibold md:my-1 capitalize w-full"}),e.jsx("h1",{className:"text-center font-semibold my-1 flex justify-center",children:e.jsx("span",{className:"px-1 text-semibold text-2xl -mt-5 mb-4 border-b-2 border-b-[#99B37C]",children:"Log In "})}),e.jsxs("div",{className:"my-3 relative text-sm",children:[e.jsxs("div",{className:"text-gray-600 static mb-1 font-semibold text-left px-8 md:px-10 ",children:["Mobile No.",e.jsx("span",{className:"text-red-500 font-bold",children:"*"})]}),e.jsx("input",{type:"text",min:0,...o.getFieldProps("mobile"),className:"cypress_mobile border-b border-b-gray-200 focus:border-b focus:border-b-indigo-500  pl-2 px-3 py-1 w-5/6 shadow-sm h-10 outline-none border border-solid border-gray-300 rounded hover:bg-gray-100",placeholder:"Enter Your mobile"}),e.jsx("div",{children:e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.mobile&&o.errors.mobile?o.errors.mobile:null})})]}),e.jsxs("div",{className:"my-3 relative text-sm mt-4",children:[e.jsxs("div",{className:"text-gray-600 static mb-1 font-semibold text-left px-8 md:px-10",children:["Password ",e.jsx("span",{className:"text-red-500 font-bold",children:"*"})]}),e.jsx("input",{type:"password",...o.getFieldProps("password"),className:"cypress_password border-b border-b-gray-200 focus:border-b focus:border-b-indigo-500  pl-2 px-3 py-1 w-5/6 shadow-sm h-10 outline-none border border-solid border-gray-300 rounded hover:bg-gray-100",placeholder:"Enter Your Password"}),e.jsx("div",{children:e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.password&&o.errors.password?o.errors.password:null})})]}),e.jsx("div",{className:" my-10"}),e.jsx("div",{className:"text-center mt-3 text-xs"}),e.jsxs("div",{className:"my-5 self-center justify-self-center relative",children:[e.jsxs("div",{className:"text-red-600 text-sm font-semibold my-3 ",children:[" ",e.jsxs("span",{className:"",children:[" ",A]})]}),u?e.jsx("div",{className:"flex justify-center",children:e.jsx(X,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})}):e.jsx("button",{type:"submit",disabled:u,className:"cypress_button_login bg-[#99B37C] hover:bg-[#99B37C] px-5 shadow-xl py-2 w-72  rounded-md text-white text-lg font-semibold",children:"Login"})]}),e.jsx("div",{className:"flex flex-row flex-wrap gapx-x-2 gap-y-2 w-full poppins justify-center",children:e.jsx("span",{className:"text-gray-700 text-sm font-semibold cursor-pointer md:w-[40%] w-full",onClick:()=>m(!0),children:"Forgot Password"})}),e.jsxs("div",{className:"text-left w-full mt-10",children:[e.jsxs("span",{onClick:()=>l("/"),className:"text-gray-700 font-semibold hover:bg-white px-3 py-1 cursor-pointer ",children:[e.jsx(ee,{className:"inline mr-2"}),"Home"]}),e.jsxs("span",{onClick:()=>l("/register"),className:"text-gray-700 font-semibold hover:bg-white px-3 py-1 cursor-pointer float-right",children:["Register ",e.jsx(te,{className:"inline ml-2"})]})]})]})})]})})})})})};export{me as default};
