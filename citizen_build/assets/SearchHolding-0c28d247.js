import{r as o,g as Q,ab as X,E as Y,a as Z,c as ee,d as w,b as te,j as t,ac as se,o as le,p as oe,$ as i,bF as re,l as I,A as ae,f as ie,b0 as ne}from"./index-ecfe615e.js";import{b as ce}from"./index.esm-38f4f0f3.js";import de from"./OtpCard-b4eab7ae.js";import xe from"./MobileNoCard-c3c504f9.js";const me=6e4;function ge(){const[y,a]=o.useState(!0),[n,E]=o.useState(),[_,f]=o.useState(!1),[L,M]=o.useState(null),[ue,P]=o.useState(null),[O,u]=o.useState(""),[p,C]=o.useState(),{notify:c}=o.useContext(Q),[j,g]=o.useState(!1),[v,S]=o.useState(null),[A,d]=o.useState(!1),[k,T]=o.useState(null),[F,h]=o.useState(!1);X("Search Property");const{api_searchDirectHolding:B}=ne(),{api_getAllUlb:D,api_sendMobileOtp:U}=ie(),{ulb_name:H,brand_tag:R}=Y(),V=Z(),q=e=>{h(!1),d(!1),u(""),f(!1),a(!0);const l={holdingNo:e==null?void 0:e.holdingNo,ulbId:e==null?void 0:e.ulbId};console.log("before fetch holding details....",l),I.post(B,l).then(s=>{var x,m;console.log("search property list",s==null?void 0:s.data),(x=s==null?void 0:s.data)!=null&&x.status?(E((m=s==null?void 0:s.data)==null?void 0:m.data),f(!0),u(""),P(l==null?void 0:l.ulbId)):(c("This holding no does not exits!","error"),u("Data not found. Please enter a valid holding no. or related ULB")),a(!1)}).catch(s=>{console.log("Error while fetching Filter Data",s),c("Something went wrong!!","error"),u("Network problem."),b(!0,"Error occured. Please try again later."),a(!1),f(!1)})},W=ee({holdingNo:w().required("This is a required field !"),ulbId:w().required("Select ULB")}),r=te({initialValues:{holdingNo:"",ulbId:""},onSubmit:e=>{console.log("at submit form.....",e),q(e)},validationSchema:W}),$=e=>{let l=e.target.name,s=e.target.value;l=="holdingNo"&&r.setFieldValue("holdingNo",re(s,r.values.holdingNo,17))},N=(e=null)=>{console.log("passed mobile no....."),a(!0);let l;e==null?l={mobileNo:v}:l={mobileNo:e},console.log("before send otp. of direct search..",l),I.post(U,l).then(s=>{var x,m;console.log("otp send response",s==null?void 0:s.data),(x=s==null?void 0:s.data)!=null&&x.status?(g(!0),c("OTP is send to your mobile no.","success")):(c((m=s==null?void 0:s.data)==null?void 0:m.message,"error"),b(!0,"Error occured. Please try again later.")),a(!1)}).catch(s=>{console.log("error otp send",s),b(!0,"Error occured. Please try again later."),a(!1)})},G=()=>{d(!1),a(!0),ae.get(D,{timeout:me}).then(function(e){var l,s;console.log("ulb list. at..",e==null?void 0:e.data),(l=e==null?void 0:e.data)!=null&&l.status?C((s=e==null?void 0:e.data)==null?void 0:s.data):d(!0),a(!1)}).catch(function(e){console.log("ulb list error.... ",e),d(!0),a(!1)})};o.useEffect(()=>{G()},[]);const z=()=>{c("Mobile no. has been verified successfully !","success"),V(`/viewDemandHoldingPropertyDirect/${L}`)},J=()=>{g(!1)},b=(e,l)=>{T(l),d(e)},K=(e,l)=>{console.log("incoming data => ",e,l),M(e),l==""||l==null||l==null?(h(!0),console.log("entered in condition")):(h(!1),S(l),N(l))};if(y)return t.jsxs(t.Fragment,{children:[t.jsx(se,{}),t.jsx("div",{className:"min-h-screen"})]});if(j)return t.jsx(de,{closeOtpModal:J,bottomNaviation:!0,headTitle:"Pay Property Tax",reSendOtp:N,verifedMobileNo:v,callback:z,setotpCardStatus:g});if(!j)return t.jsxs(t.Fragment,{children:[F&&t.jsx(xe,{title:"Enter Mobile No.",desc:"Enter mobile no. to proceed for payment",setverifedMobileNo:e=>{S(e),N(e)},closeMobileModal:()=>h(!1)}),y&&t.jsx(le,{}),A&&t.jsx(oe,{activateBottomErrorCard:b,errorTitle:k}),t.jsxs("div",{className:"px-2 md:px-10 mt-16",children:[t.jsxs("div",{className:"border shadow-xl bg-white mt-6",children:[t.jsx("div",{className:"flex ml-5 mt-2 ",children:t.jsx("p",{className:"font-semibold text-3xl ml-4 mt-1 text-gray-600",children:"Search Property"})}),t.jsx("form",{onSubmit:r.handleSubmit,onChange:$,children:t.jsxs("div",{className:"flex flex-col md:flex-row justify-center my-5 m-10 ",children:[t.jsxs("div",{className:"form-group col-span-12 mb-4 md:px-10",children:[t.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["ULB",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),t.jsxs("select",{id:"basic_details_1",...r.getFieldProps("ulbId"),className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md cursor-pointer ",children:[t.jsx("option",{value:"",disabled:!0,selected:!0,children:"Select"}),R!="AMC"?p==null?void 0:p.map(e=>t.jsx("option",{value:e.id,children:e.ulb_name})):t.jsx("option",{value:"2",children:H})]}),t.jsx("span",{className:"text-red-600 absolute text-xs",children:r.touched.ulbId&&r.errors.ulbId?r.errors.ulbId:null})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Holding/PT No.",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",...r.getFieldProps("holdingNo"),className:" w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),t.jsx("p",{className:"text-red-500 text-xs",children:r.touched.holdingNo&&r.errors.holdingNo?r.errors.holdingNo:null})]}),t.jsx("div",{className:"mt-4 md:px-10",children:t.jsx("button",{type:"submit",className:"w-full border border-indigo-500 bg-indigo-600 hover:bg-indigo-500 text-white hover:text-black shadow-lg rounded-sm text-base font-semibold px-5 m-3 py-1",children:t.jsxs("p",{className:"flex text-center justify-center items-center",children:[t.jsx(ce,{className:"inline mr-2"}),"Search record"]})})})]})})]}),t.jsxs("div",{className:"mt-10",children:[_&&(n==null?void 0:n.length)!=0&&t.jsxs("div",{className:"col-span-10 bg-gray-50 p-4 overflow-x-scroll",children:[t.jsx("div",{className:"flex flex-row",children:t.jsx("h1",{className:"px-1 font-semibold font-serif text-2xl mt-4",children:"All Transcations"})}),t.jsxs("table",{className:"min-w-full leading-normal mt-10",children:[t.jsx("thead",{className:"font-bold text-left text-sm bg-indigo-50 text-gray-600",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"#"}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"ACTION"}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"OWNER'S NAME"}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"HOLDING NO"}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"NEW HOLDING NO"}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"MOBILE NO"}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"WARD NO."}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"ULB"}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"ADDRESS"})]})}),t.jsx("tbody",{className:"text-sm",children:t.jsx(t.Fragment,{children:n==null?void 0:n.map(e=>t.jsxs("tr",{className:"bg-white shadow-lg border-b border-gray-200",children:[t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:"1"}),t.jsxs("td",{className:"px-2 py-2 text-sm text-left",children:[" ",t.jsx("button",{onClick:()=>K(e==null?void 0:e.id,e==null?void 0:e.mobile_no),className:"bg-sky-200 px-3 py-1 rounded-lg shadow-lg hover:shadow-xl hover:bg-sky-800 hover:text-white text-black",children:"View"})]}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.owner_name)}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.holding_no)}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.new_holding_no)}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.mobile_no)}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.ward_name)}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.ulb)}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.prop_address)})]}))})})]})]}),t.jsx("div",{className:"text-xl font-semibold text-red-400 text-center",children:O}),t.jsx("div",{className:"w-full h-40"})]})]})]})}export{ge as default};
