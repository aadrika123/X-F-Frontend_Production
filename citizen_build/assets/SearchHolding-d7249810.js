import{v as te,r,g as ae,af as le,a as oe,c as re,d as x,b as se,j as e,O as ne,i as ie,q as de,ag as ce,bM as ue,bN as me,bO as xe,bx as be,m as b,w as he,f as pe}from"./index-41e6223c.js";function Ne(){const{t:n}=te(),[L,s]=r.useState(!1),[i,w]=r.useState(),[F,h]=r.useState(!1),[v,p]=r.useState(null),[fe,k]=r.useState(null),[E,f]=r.useState("");r.useState();const{notify:u}=r.useContext(ae),[S,g]=r.useState(!1),[B,O]=r.useState(null),[T,P]=r.useState(!1),[D,q]=r.useState(null),[A,I]=r.useState(!1),[y,V]=r.useState([]),[Z,N]=r.useState(!1),[j,z]=r.useState([]);le("Search Property");const{api_getAllUlb:ge,api_sendMobileOtp:U,unauth_ward_by_zone:W,unauth_search_property:H}=pe(),$=oe(),R={id:v,setId:p,showDemandStatus:Z,setshowDemandStatus:N,data:i},M=t=>{I(!1),P(!1),f(""),h(!1),s(!0);let l={zone:o.values.zone,wardId:o.values.wardId,parameter:o.values.parameter,filteredBy:o.values.filterBy||"propertyNo",propId:t};console.log("before fetch holding details....",l),b.post(H,l).then(a=>{var d,c,_;console.log("search property list",(d=a==null?void 0:a.data)==null?void 0:d.data),(c=a==null?void 0:a.data)!=null&&c.status&&(w((_=a==null?void 0:a.data)==null?void 0:_.data),h(!0),f(""),k(l==null?void 0:l.ulbId)),s(!1)}).catch(a=>{console.log("Error while fetching Filter Data",a),u("Something went wrong!!","error"),f("Network problem."),m(!0,"Error occured. Please try again later."),s(!1),h(!1)})},G=re({filterBy:x().required("This is a required field."),zone:x().required("This is a required field."),wardId:x().required("This is a required field."),parameter:x().required("This is a required field.")}),o=se({initialValues:{filterBy:"propertyNo",zone:"",wardId:"",parameter:"",propId:""},onSubmit:t=>{console.log("at submit form.....",t),p(null),N(!1),M(t)},validationSchema:G}),J=(t,l)=>{o.setFieldValue("parameter",l),o.setFieldValue("propId",t),M(t),z([])},K=t=>{let l=t.target.name,a=t.target.value;l=="holdingNo"&&o.setFieldValue("holdingNo",xe(a,o.values.holdingNo,17)),l=="zone"&&ee(a)},Q=t=>{s(!0),p(null),N(!1);let l={zone:o.values.zone,wardId:o.values.wardId,parameter:t,filteredBy:o.values.filterBy||"propertyNo"};if((l==null?void 0:l.zone)==""||(l==null?void 0:l.wardId)==""||(l==null?void 0:l.filteredBy)==""){be("Fill all fields to search for property "),s(!1);return}b.post(H,l).then(a=>{console.log("property response",a.data.data),a.data.status&&(w(a.data.data.data),z(a.data.data.data)),s(!1)}).catch(a=>{console.log(a),s(!1)})},C=(t=null)=>{console.log("passed mobile no....."),s(!0);let l;t==null?l={mobileNo:B}:l={mobileNo:t},console.log("before send otp. of direct search..",l),b.post(U,l).then(a=>{var d,c;console.log("otp send response",a==null?void 0:a.data),(d=a==null?void 0:a.data)!=null&&d.status?(g(!0),u("OTP is send to your mobile no.","success")):(u((c=a==null?void 0:a.data)==null?void 0:c.message,"error"),m(!0,"Error occured. Please try again later.")),s(!1)}).catch(a=>{console.log("error otp send",a),m(!0,"Error occured. Please try again later."),s(!1)})},X=()=>{u("Mobile no. has been verified successfully !","success"),$(`/viewDemandHoldingPropertyDirect/${v}`)},Y=()=>{g(!1)},m=(t,l)=>{q(l),P(t)},ee=t=>{s(!0);let l={zoneId:t};console.log("before fetch wardby old ward...",l),b.post(W,l,he()).then(function(a){console.log("wardlist by zone id list ....",a.data.data),V(a.data.data),s(!1)}).catch(function(a){console.log("errorrr.... ",a),s(!1)})};if(S)return e.jsx(ne,{closeOtpModal:Y,bottomNaviation:!0,headTitle:n("tranSearchHoldingPage.payPropertyTaxLabel.label"),reSendOtp:C,verifedMobileNo:B,callback:X,setotpCardStatus:g});if(!S)return e.jsxs(e.Fragment,{children:[A&&e.jsx(ie,{title:"Enter Mobile No.",desc:"Enter mobile no. to proceed for payment",setverifedMobileNo:t=>{O(t),C(t)},closeMobileModal:()=>I(!1)}),T&&e.jsx(de,{activateBottomErrorCard:m,errorTitle:D}),e.jsxs("div",{className:"px-2 md:px-10 py-4 rounded-l bg-white border-0 border-slate-200 md:w-11/12 min-h-fit mx-auto shadow shadow-indigo-400 ",children:[e.jsxs("div",{className:"border shadow-xl bg-white mt-6",children:[e.jsxs("div",{className:"flex justify-between ml-5 mt-2 ",children:[e.jsx("p",{className:"font-semibold text-3xl ml-4 mt-1 text-gray-600",children:n("tranSearchHoldingPage.searchPropertyLabel.label")}),L&&e.jsx(ce,{})]}),e.jsx("form",{onSubmit:o.handleSubmit,onChange:K,children:e.jsxs("div",{className:"w-full  pl-10 pr-4 grid grid-cols-1 md:grid-cols-5 gap-4 py-12",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"min-w-[80px] whitespace-nowrap mx-2  form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[n("tranSearchHoldingPage.searchPropertyLabel.label"),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...o.getFieldProps("filterBy"),className:"min-w-[80px] mx-2  cypress_filterBy cursor-pointer w-full px-3 py-2 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e.jsx("option",{value:"",selected:!0,children:n("tranSearchHoldingPage.selectLabel.label")}),e.jsx("option",{value:"propertyNo",children:"Property No"}),e.jsx("option",{value:"holdingNo",children:"Holding No."}),e.jsx("option",{value:"ownerName",children:"Owner Name"}),e.jsx("option",{value:"mobileNo",children:"Mobile No"})]}),e.jsx("p",{className:"text-red-500 text-xs",children:o.touched.filterBy&&o.errors.filterBy?o.errors.filterBy:null})]}),e.jsxs("div",{className:"",children:[e.jsxs("label",{className:"min-w-[80px] mx-2  form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[n("tranSearchHoldingPage.zoneLabel.label"),e.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e.jsxs("select",{id:"basic_details_1",...o.getFieldProps("zone"),className:"min-w-[80px] mx-2  form-control block w-full px-3 py-2 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md cursor-pointer ",children:[e.jsx("option",{value:"",selected:!0,children:n("tranSearchHoldingPage.selectLabel.label")}),e.jsx("option",{value:"1",children:"Zone A-East"}),e.jsx("option",{value:"2",children:"Zone B-West"}),e.jsx("option",{value:"3",children:"Zone C-North"}),e.jsx("option",{value:"4",children:"Zone D-South"})]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.zone&&o.errors.zone?o.errors.zone:null})]}),e.jsxs("div",{className:"",children:[e.jsxs("label",{className:"min-w-[80px] mx-2  form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[n("tranSearchHoldingPage.wardNoLabel.label"),e.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e.jsxs("select",{id:"basic_details_1",...o.getFieldProps("wardId"),className:"min-w-[80px] mx-2  form-control block w-full px-3 py-2 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md cursor-pointer ",children:[e.jsx("option",{value:"",disabled:!0,selected:!0,children:n("tranSearchHoldingPage.selectLabel.label")}),y==null?void 0:y.map((t,l)=>e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.ward_name},l))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:o.touched.zone&&o.errors.zone?o.errors.zone:null})]}),e.jsxs("div",{className:"",children:[e.jsxs("label",{className:"min-w-[80px] mx-2  form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[o.values.filterBy=="propertyNo"&&n("tranSearchHoldingPage.oldPropertyNo.label"),o.values.filterBy=="holdingNo"&&n("tranSearchHoldingPage.propertyHoldingNumber.label"),o.values.filterBy=="ownerName"&&n("tranSearchHoldingPage.holdingOwnersName.label"),o.values.filterBy=="mobileNo"&&n("tranSearchHoldingPage.holdingMobileNumber.label"),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"border border-solid border-gray-300 rounded focus:bg-white focus:border-blue-600 focus:outline  shadow-md mr-1 flex",children:[e.jsx("input",{type:"text",...o.getFieldProps("parameter"),id:"parameter",onBlur:t=>Q(t.target.value),className:" min-w-[80px] mx-2 w-full px-3 py-2 text-base font-normal text-gray-700 bg-white bg-clip-padding transition ease-in-out m-0 focus:outline-none focus:text-gray-700 placeholder-gray-300"}),e.jsx("span",{className:"pt-1 cursor-pointer",onClick:()=>window.document.getElementById("parameter").focus(),children:e.jsx(ue,{})})]}),e.jsx("p",{className:"text-red-500 text-xs",children:o.touched.parameter&&o.errors.parameter?o.errors.parameter:null}),e.jsx("div",{className:"min-w-[100px] border-0 relative border-cyan-500 bg-cyan-50 text-amber-800 font-semibold text-xs max-h-24 overflow-y-auto shadow",children:e.jsx("ul",{children:j==null?void 0:j.map((t,l)=>e.jsxs("li",{className:"pl-4 py-2 border-b cursor-pointer hover:text-amber-900 hover:scale-100 hover:bg-cyan-100",onClick:()=>J(t==null?void 0:t.id,t==null?void 0:t.property_no),children:[t==null?void 0:t.property_no," "]},l))})})]})]})})]}),e.jsxs("div",{className:"mt-10",children:[F&&(i==null?void 0:i.length)>0?e.jsxs("div",{className:"col-span-10 bg-gray-50 p-4 overflow-x-scroll",children:[e.jsx("div",{className:"flex flex-row"}),e.jsx("table",{className:"min-w-full leading-normal mt-10",children:e.jsxs("tbody",{className:"text-sm",children:[e.jsx(e.Fragment,{}),console.log("dataaaa",i)]})})]}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-sm "})}),e.jsx(me,{values:R}),e.jsx("div",{className:"text-xl font-semibold text-red-400 text-center",children:E}),e.jsx("div",{className:"w-full h-40"})]})]})]})}export{Ne as default};
