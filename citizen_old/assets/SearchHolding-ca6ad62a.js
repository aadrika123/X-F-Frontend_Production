import{t as X,r as o,g as Y,ac as Z,H as ee,a as te,c as le,d as P,b as se,j as t,ad as re,o as oe,p as ae,a0 as i,bG as ne,l as L,A as ie,f as ce,b1 as de}from"./index-5555ea77.js";import{b as xe}from"./index.esm-b67c0e56.js";import be from"./OtpCard-373e7a84.js";import he from"./MobileNoCard-37d6f651.js";const me=6e4;function ye(){const{t:r}=X(),[j,n]=o.useState(!0),[c,H]=o.useState(),[I,f]=o.useState(!1),[_,M]=o.useState(null),[ue,C]=o.useState(null),[k,m]=o.useState(""),[p,E]=o.useState(),{notify:d}=o.useContext(Y),[S,N]=o.useState(!1),[v,w]=o.useState(null),[T,x]=o.useState(!1),[F,A]=o.useState(null),[B,u]=o.useState(!1);Z("Search Property");const{api_searchDirectHolding:O}=de(),{api_getAllUlb:U,api_sendMobileOtp:D}=ce(),{ulb_name:q,brand_tag:R}=ee(),V=te(),$=e=>{u(!1),x(!1),m(""),f(!1),n(!0);const s={holdingNo:e==null?void 0:e.holdingNo,ulbId:e==null?void 0:e.ulbId};console.log("before fetch holding details....",s),L.post(O,s).then(l=>{var b,h;console.log("search property list",l==null?void 0:l.data),(b=l==null?void 0:l.data)!=null&&b.status?(H((h=l==null?void 0:l.data)==null?void 0:h.data),f(!0),m(""),C(s==null?void 0:s.ulbId)):(d("This holding no does not exits!","error"),m("Data not found. Please enter a valid holding no. or related ULB")),n(!1)}).catch(l=>{console.log("Error while fetching Filter Data",l),d("Something went wrong!!","error"),m("Network problem."),g(!0,"Error occured. Please try again later."),n(!1),f(!1)})},z=le({holdingNo:P().required("This is a required field !"),ulbId:P().required("Select ULB")}),a=se({initialValues:{holdingNo:"",ulbId:""},onSubmit:e=>{console.log("at submit form.....",e),$(e)},validationSchema:z}),G=e=>{let s=e.target.name,l=e.target.value;s=="holdingNo"&&a.setFieldValue("holdingNo",ne(l,a.values.holdingNo,17))},y=(e=null)=>{console.log("passed mobile no....."),n(!0);let s;e==null?s={mobileNo:v}:s={mobileNo:e},console.log("before send otp. of direct search..",s),L.post(D,s).then(l=>{var b,h;console.log("otp send response",l==null?void 0:l.data),(b=l==null?void 0:l.data)!=null&&b.status?(N(!0),d("OTP is send to your mobile no.","success")):(d((h=l==null?void 0:l.data)==null?void 0:h.message,"error"),g(!0,"Error occured. Please try again later.")),n(!1)}).catch(l=>{console.log("error otp send",l),g(!0,"Error occured. Please try again later."),n(!1)})},J=()=>{x(!1),n(!0),ie.get(U,{timeout:me}).then(function(e){var s,l;console.log("ulb list. at..",e==null?void 0:e.data),(s=e==null?void 0:e.data)!=null&&s.status?E((l=e==null?void 0:e.data)==null?void 0:l.data):x(!0),n(!1)}).catch(function(e){console.log("ulb list error.... ",e),x(!0),n(!1)})};o.useEffect(()=>{J()},[]);const K=()=>{d("Mobile no. has been verified successfully !","success"),V(`/viewDemandHoldingPropertyDirect/${_}`)},Q=()=>{N(!1)},g=(e,s)=>{A(s),x(e)},W=(e,s)=>{console.log("incoming data => ",e,s),M(e),s==""||s==null||s==null?(u(!0),console.log("entered in condition")):(u(!1),w(s),y(s))};if(j)return t.jsxs(t.Fragment,{children:[t.jsx(re,{}),t.jsx("div",{className:"min-h-screen"})]});if(S)return t.jsx(be,{closeOtpModal:Q,bottomNaviation:!0,headTitle:r("tranSearchHoldingPage.payPropertyTaxLabel.label"),reSendOtp:y,verifedMobileNo:v,callback:K,setotpCardStatus:N});if(!S)return t.jsxs(t.Fragment,{children:[B&&t.jsx(he,{title:"Enter Mobile No.",desc:"Enter mobile no. to proceed for payment",setverifedMobileNo:e=>{w(e),y(e)},closeMobileModal:()=>u(!1)}),j&&t.jsx(oe,{}),T&&t.jsx(ae,{activateBottomErrorCard:g,errorTitle:F}),t.jsxs("div",{className:"px-2 md:px-10 mt-16",children:[t.jsxs("div",{className:"border shadow-xl bg-white mt-6",children:[t.jsx("div",{className:"flex ml-5 mt-2 ",children:t.jsx("p",{className:"font-semibold text-3xl ml-4 mt-1 text-gray-600",children:r("tranSearchHoldingPage.searchPropertyLabel.label")})}),t.jsx("form",{onSubmit:a.handleSubmit,onChange:G,children:t.jsxs("div",{className:"flex flex-col md:flex-row justify-center my-5 m-10 ",children:[t.jsxs("div",{className:"form-group col-span-12 mb-4 md:px-10",children:[t.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[r("tranSearchHoldingPage.ulbLabel.label"),t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),t.jsxs("select",{id:"basic_details_1",...a.getFieldProps("ulbId"),className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md cursor-pointer ",children:[t.jsx("option",{value:"",disabled:!0,selected:!0,children:r("tranSearchHoldingPage.selectLabel.label")}),R!="AMC"?p==null?void 0:p.map(e=>t.jsx("option",{value:e.id,children:e.ulb_name})):t.jsx("option",{value:"2",children:q})]}),t.jsx("span",{className:"text-red-600 absolute text-xs",children:a.touched.ulbId&&a.errors.ulbId?a.errors.ulbId:null})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[r("tranSearchHoldingPage.holdingPtNoLabel.label"),t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",...a.getFieldProps("holdingNo"),className:" w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),t.jsx("p",{className:"text-red-500 text-xs",children:a.touched.holdingNo&&a.errors.holdingNo?a.errors.holdingNo:null})]}),t.jsx("div",{className:"mt-4 md:px-10",children:t.jsx("button",{type:"submit",className:"w-full border border-indigo-500 bg-indigo-600 hover:bg-indigo-500 text-white hover:text-black shadow-lg rounded-sm text-base font-semibold px-5 m-3 py-1",children:t.jsxs("p",{className:"flex text-center justify-center items-center",children:[t.jsx(xe,{className:"inline mr-2"}),r("tranSearchHoldingPage.searchRecordLabel.label")]})})})]})})]}),t.jsxs("div",{className:"mt-10",children:[I&&(c==null?void 0:c.length)!=0&&t.jsxs("div",{className:"col-span-10 bg-gray-50 p-4 overflow-x-scroll",children:[t.jsx("div",{className:"flex flex-row",children:t.jsx("h1",{className:"px-1 font-semibold font-serif text-2xl mt-4",children:r("tranSearchHoldingPage.allTransactionsLabel.label")})}),t.jsxs("table",{className:"min-w-full leading-normal mt-10",children:[t.jsx("thead",{className:"font-bold text-left text-sm bg-indigo-50 text-gray-600",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"#"}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:r("tranSearchHoldingPage.actionLabel.label")}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:r("tranSearchHoldingPage.ownersNameLabel.label")}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:r("tranSearchHoldingPage.holdingNoLabel.label")}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:r("tranSearchHoldingPage.newHoldingNoLabel.label")}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:r("tranSearchHoldingPage.mobileNoLabel.label")}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:r("tranSearchHoldingPage.wardNoLabel.label")}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:r("tranSearchHoldingPage.ulbLabel2.label")}),t.jsx("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:r("tranSearchHoldingPage.addressLabel.label")})]})}),t.jsx("tbody",{className:"text-sm",children:t.jsx(t.Fragment,{children:c==null?void 0:c.map(e=>t.jsxs("tr",{className:"bg-white shadow-lg border-b border-gray-200",children:[t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:"1"}),t.jsxs("td",{className:"px-2 py-2 text-sm text-left",children:[" ",t.jsx("button",{onClick:()=>W(e==null?void 0:e.id,e==null?void 0:e.mobile_no),className:"bg-sky-200 px-3 py-1 rounded-lg shadow-lg hover:shadow-xl hover:bg-sky-800 hover:text-white text-black",children:r("tranSearchHoldingPage.viewLabel.label")})]}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.owner_name)}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.holding_no)}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.new_holding_no)}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.mobile_no)}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.ward_name)}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.ulb)}),t.jsx("td",{className:"px-2 py-2 text-sm text-left",children:i(e==null?void 0:e.prop_address)})]}))})})]})]}),t.jsx("div",{className:"text-xl font-semibold text-red-400 text-center",children:k}),t.jsx("div",{className:"w-full h-40"})]})]})]})}export{ye as default};
