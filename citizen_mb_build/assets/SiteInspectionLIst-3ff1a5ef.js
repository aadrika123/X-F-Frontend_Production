import{M as A,R as P,r as c,a as T,d as F,f as h,g as E,E as q,b as e,j as a,F as i}from"./index-d9bca912.js";import{h as b}from"./moment-fbc5633a.js";import{W as R}from"./WaterApiList-bd6e828c.js";import $ from"./CommonLoader-2369cf46.js";import"./Blocks-bc37b01b.js";import"./BeatLoader-5bf36329.js";const z={overlay:{background:"#e6e6fc"},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-40%",transform:"translate(-50%, -50%)",backgroundColor:"transparent",border:"none",height:"500px"}};function G(d){A.setAppElement("#root");const[v,D]=P.useState(!1),[p,x]=c.useState(!1),u=d.id,w=T(),{api_waterInspectionSaveDate:f,header:S}=R(),y=F({inspectionTime:h().required("Enter Meter Reading"),inspectionDate:h().required("Select Connection Date")}),l=E({enableReinitialize:!0,initialValues:{inspectionTime:"",inspectionDate:"",applicationId:u},onSubmit:(s,N)=>{console.log("The Final Data is...",s),k(s)},validationSchema:y}),M=s=>{s.target.name,s.target.value},k=s=>{x(!1);const N={applicationId:s==null?void 0:s.applicationId,inspectionDate:b(s==null?void 0:s.inspectionDate,"YYYY-MM-DD").format("DD-MM-YYYY"),inspectionTime:s==null?void 0:s.inspectionTime};q.post(f,N,S).then(o=>{o.data.status?(console.log("Data Saved",o),o.data.data.canView?(console.log(o.data.data.canView),w(`/water-site-inspection-form/${u}`)):m()):(console.log("Data Not Saved..",o),x("Failed to Save"))}).catch(o=>{x("Exception While Saving.."),console.log("Exception While Time Save..",o)})};c.useEffect(()=>{d.openModal>0&&D(!0)},[d.openModal]);function C(){}function m(){D(!1),d.refetch()}return e("div",{className:"",children:e(A,{isOpen:v,onAfterOpen:C,onRequestClose:m,style:z,contentLabel:"Example Modal",children:e("div",{children:e("div",{class:"relative w-full h-full max-w-3xl md:h-auto border-indigo-600 shadow-indigo-200 shadow-sm rounded",children:a("div",{class:"relative bg-white rounded-lg shadow ",children:[a("div",{class:"flex items-start justify-between p-4 border-b rounded-t dark:border-gray-600",children:[a("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white",children:["Set Date and Time",e("p",{className:"text-sm font-light",children:"For Site Inspection"})]}),a("button",{onClick:m,class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"defaultModal",children:[e("svg",{"aria-hidden":"true",class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})}),e("span",{class:"sr-only",children:"Close modal"})]})]}),e("div",{className:" bg-white rounded-lg shadow-xl p-4",children:a("form",{onSubmit:l.handleSubmit,onChange:M,className:"p-4 relative",children:[a("div",{className:"",children:[e("div",{className:"flex-1",children:a("div",{className:"form-group mb-3 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-900 text-sm font-semibold",children:["Date ",e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e("input",{...l.getFieldProps("inspectionDate"),type:"date",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer"}),e("span",{className:"text-red-600 absolute text-xs",children:l.touched.inspectionDate&&l.errors.inspectionDate?l.errors.inspectionDate:null})]})}),e("div",{className:"flex-1",children:a("div",{className:"form-group mb-3 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-900 text-sm font-semibold",children:["Time ",e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e("input",{...l.getFieldProps("inspectionTime"),type:"time",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Enter Meter Reading"}),e("span",{className:"text-red-600 absolute text-xs",children:l.touched.inspectionTime&&l.errors.inspectionTime?l.errors.inspectionTime:null})]})})]}),p&&e("div",{children:e("div",{className:" absolute text-red-500",children:e("p",{className:"text-center",children:p})})}),a("div",{className:"flex justify-center p-2 border-t border-gray-200 rounded-b",children:[e("button",{type:"button",onClick:m,class:"mx-2 text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 rounded border border-red-200 text-sm font-medium px-5 py-1 focus:z-10 ",children:"Cancel"}),e("button",{type:"submit",class:"mx-2 text-white disabled:bg-gray-500 disabled:scale-100 bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded text-sm px-5 py-1 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Submit"})]})]})})]})})})})})}function ee(){const[d,v]=c.useState(),[D,p]=c.useState(!1),[x,u]=c.useState(!1),[w,f]=c.useState(!1),[S,y]=c.useState(!1),[l,M]=c.useState(0),[k,C]=c.useState(),{api_waterSiteInspectionList:m,header:s}=R(),N=F({fromDate:h().when("searchBy",{is:"byDate",then:h().required("Field is required")}),toDate:h().when("searchBy",{is:"byDate",then:h().required("Field is required")}),searchBy:h().required("This is a required field !")}),o=E({initialValues:{fromDate:"",toDate:"",searchBy:""},onSubmit:t=>{V(t)},validationSchema:N}),j=T(),V=t=>{u(!0),p(!1);const r={fromDate:b(t.fromDate).format("DD-MM-YYYY"),toDate:b(t.toDate).format("DD-MM-YYYY"),filterBy:t.searchBy,parameter:t.applicationNo};console.log("Payload..",r),q.post(m,r,s).then(n=>{var g;console.log("this ==== List of site inspection...",n==null?void 0:n.data),v((g=n==null?void 0:n.data)==null?void 0:g.data),p(!0),u(!1)}).catch(n=>{console.log("Error while fetching Filter Data",n),p(!1),u(!1)})},O=t=>{let r=t.target.name,n=t.target.value;r==="searchBy"&&(n=="byDate"?f(!0):f(!1)),r==="searchBy"&&(n=="byApplication"?y(!0):y(!1))},W=(t,r)=>{console.log("Handle View Button Clicked..",r),r?j(`/water-site-inspection-form/${t}`):(C(t),M(n=>n+1))},H=()=>{console.log("Refetch Called.."),o.handleSubmit()};return console.log("readymadeListreadymadeListDataStatus",d),a(i,{children:[e(G,{refetch:H,openModal:l,id:k}),x&&e($,{}),a("div",{className:"border shadow-xl bg-white mt-6",children:[e("div",{className:"flex justify-between mx-5 my-3",children:e("div",{className:"flex ",children:e("p",{className:"font-bold text-2xl text-gray-600",children:"List of Site Inspection"})})}),e("form",{onSubmit:o.handleSubmit,onChange:O,children:a("div",{className:"justify-center m-10 space-y-5",children:[a("div",{className:"",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Search By",e("span",{className:"text-red-500",children:"*"})]}),a("select",{name:"searchBy",onChange:o.handleChange,className:"cursor-pointer w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e("option",{value:"",children:"Select"}),e("option",{value:"byDate",children:"Date"}),e("option",{value:"byApplication",children:"Application No"})]}),e("p",{className:"text-red-500 text-xs",children:o.touched.searchBy&&o.errors.searchBy?o.errors.searchBy:null})]}),w&&a("div",{className:"space-y-5",children:[a("div",{children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["From Data",e("span",{className:"text-red-500",children:"*"})]}),e("input",{type:"date",name:"fromDate",onChange:o.handleChange,className:"cursor-pointer w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e("p",{className:"text-red-500 text-xs",children:o.touched.fromDate&&o.errors.fromDate?o.errors.fromDate:null})]}),a("div",{children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["To Data",e("span",{className:"text-red-500",children:"*"})]}),e("input",{type:"date",name:"toDate",onChange:o.handleChange,className:"cursor-pointer w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e("p",{className:"text-red-500 text-xs",children:o.touched.toDate&&o.errors.toDate?o.errors.toDate:null})]})]}),S&&a("div",{children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Application No",e("span",{className:"text-red-500",children:"*"})]}),e("input",{type:"text",name:"applicationNo",onChange:o.handleChange,className:"cursor-pointer w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e("p",{className:"text-red-500 text-xs",children:o.touched.applicationNo&&o.errors.applicationNo?o.errors.applicationNo:null})]}),e("div",{className:"text-center ",children:e("button",{type:"submit",className:"mt-3 w-full border border-indigo-600 bg-indigo-600 hover:bg-indigo-400 text-white hover:text-black shadow-lg rounded-sm text-base font-semibold px-5 py-1",children:e("p",{className:"",children:" Search record "})})})]})}),e("div",{className:"m-10"}),e("div",{className:"mt-10 mx-4",children:d?a("div",{className:"w-full relative bg-indigo-50 shadow-md  rounded-sm pb-2 border-2 border-indigo-600 mb-4 select-none cursor-pointer",children:[e("div",{className:"font-semibold bg-indigo-600 px-4 text-white",children:"Consumer Details"}),e("div",{className:"w-full rounded-lg space-b-2",children:e("div",{className:"",children:d&&d.map((t,r)=>{var n,g,Y,I,B,L;return a("div",{children:[a("div",{className:"w-full md:w-[40%] grid grid-cols-12 p-4",children:[a(i,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Application No"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:t==null?void 0:t.application_no})]}),a(i,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Ward No"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:t==null?void 0:t.ward_name})]}),a(i,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Apply Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:t!=null&&t.apply_date?b(t==null?void 0:t.apply_date,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"})]}),a(i,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Scheduled Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:(n=t==null?void 0:t.SiteInspectionDate)!=null&&n.inspection_date?b((g=t==null?void 0:t.SiteInspectionDate)==null?void 0:g.inspection_date,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"})]}),a(i,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Scheduled Time"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:(Y=t==null?void 0:t.SiteInspectionDate)!=null&&Y.inspection_time?b((I=t==null?void 0:t.SiteInspectionDate)==null?void 0:I.inspection_time,"h:mm:ss A").format("HH:mm A"):"N/A"})]}),(t==null?void 0:t.holding_no)&&a(i,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Holding No"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:t==null?void 0:t.holding_no})]}),(t==null?void 0:t.saf_no)&&a(i,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Saf No"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:t==null?void 0:t.saf_no})]}),a(i,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Property Type"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:t==null?void 0:t.property_type})]}),a(i,{children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Address"}),a("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-sm",children:[t==null?void 0:t.address,", ",t==null?void 0:t.pin]})]})]},r),e("div",{className:"float-right -mt-4 -pl-1",children:e("button",{type:"button",onClick:()=>{var _;return W(t.id,(_=t==null?void 0:t.SiteInspectionDate)==null?void 0:_.inspection_date)},className:"px-3 mt-1 rounded-l-sm -mr-0.5 bg-indigo-600 hover:bg-indigo-700 text-white text-sm",children:(B=t==null?void 0:t.SiteInspectionDate)!=null&&B.site_verify_status?"Start Re-Inspection":(L=t==null?void 0:t.SiteInspectionDate)!=null&&L.inspection_date?"View Details":"Schedule Inspection"})})]})})})})]}):e("div",{})})]})]})}export{ee as default};
