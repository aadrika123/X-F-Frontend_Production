import{a as j,r as l,c as D,d as T,e as F,f as _,g as J,b as a,F as P,j as n,A as q,h as B,P as M}from"./index-aa793834.js";import{l as $}from"./logo1-44af78fe.js";/* empty css                */import{R as z}from"./Blocks-9e9cbffa.js";const W=()=>{const N=j(),{notify:d,setisLoggedIn:y,setheartBeatCounter:S}=l.useContext(D),[r,v]=l.useState(null),[s,L]=l.useState(),{api_login:E}=M(),[A,u]=l.useState(!1),I=T({email:F().required("Enter email"),password:_().required("Enter password")}),t=J({initialValues:{email:"",password:""},onSubmit:o=>{O()},validationSchema:I}),g=["TAX COLLECTOR","ULB TAX COLLECTOR","TEAM LEADER"],k=l.useMemo(()=>Array.isArray(r)&&r.some(o=>g.includes(o)),[r]);l.useEffect(()=>{var o,e,i;r!=null&&(k?(d("Login Successfull !!! ","success"),window.localStorage.setItem("menuList",JSON.stringify((o=s==null?void 0:s.userDetails)==null?void 0:o.menuPermission)),window.localStorage.setItem("userName",JSON.stringify((e=s==null?void 0:s.userDetails)==null?void 0:e.userName)),window.localStorage.setItem("roles",JSON.stringify((i=s==null?void 0:s.userDetails)==null?void 0:i.role)),window.location.replace("/property/mobile-modules")):d("You don't have permission of Tax Collector !!!","warn"))},[r]);const m=JSON.parse(window.localStorage.getItem("roles")),c=window.localStorage.getItem("token"),C=l.useMemo(()=>Array.isArray(m)&&m.some(o=>g.includes(o)),[m,c]);l.useEffect(()=>{c!=""&&c!=null&&c!=null&&C&&N("/dashboard")},[]);const O=()=>{let o={email:t.values.email,password:t.values.password,type:"mobile"};console.log("--1--before login send...",o),q.post(E,o,B()).then(function(e){var i,w,f,x,h,p,b;console.log("login response => ",e),e.data.status==!0?(console.log("--2--login response...",e),window.localStorage.setItem("token",(w=(i=e==null?void 0:e.data)==null?void 0:i.data)==null?void 0:w.token),window.localStorage.setItem("isLoggedIn",!0),L((f=e==null?void 0:e.data)==null?void 0:f.data),v((p=(h=(x=e==null?void 0:e.data)==null?void 0:x.data)==null?void 0:h.userDetails)==null?void 0:p.role),S(R=>R+1),y(!0)):(u(!1),d((b=e==null?void 0:e.data)==null?void 0:b.message,"error"))}).catch(function(e){u(!1),console.log("--2--login error...",e),d("Something went wrong !!! ","error")})};return a(P,{children:a("div",{className:" h-screen bg-zinc-100 flex flex-row flex-wrap justify-center items-center",children:n("form",{onChange:t.handleChange,onSubmit:t.handleSubmit,className:"flex flex-col gap-2 w-max h-max shadow-lg rounded-md px-10 py-4 bg-white text-zinc-700 animate__animated animate__fadeInDown",children:[n("div",{className:"flex flex-row flex-wrap gap-2 items-center",children:[a("img",{src:$,alt:"",className:"w-16"}),n("div",{className:"text-xl uppercase tracking-wide font-semibold",children:["Urban Development & ",a("br",{})," Housing Department"]})]}),a("hr",{}),n("div",{className:"mt-6 flex flex-col flex-wrap gap-2",children:[a("label",{htmlFor:"email",className:"text-sm",children:"Email :"}),a("input",{type:"email",name:"email",id:"email",className:" rounded-md bg-transparent border-t-[1px] border-l-[1px] shadow-md bg-indigo-50 focus:bg-white px-4 py-2 text-sm focus:outline-indigo-600",placeholder:"Enter email"}),t.errors.email&&t.touched.email&&a("span",{className:"text-red-600 text-xs",children:t.errors.email})]}),n("div",{className:"mt-4 flex flex-col flex-wrap gap-2",children:[a("label",{htmlFor:"password",className:"text-sm",children:"Password :"}),a("input",{type:"password",name:"password",id:"password",className:" rounded-md bg-transparent border-t-[1px] border-l-[1px] shadow-md bg-indigo-50 focus:bg-white px-4 py-2 text-sm focus:outline-indigo-600",placeholder:"Enter password"}),t.errors.password&&t.touched.password&&a("span",{className:"text-red-600 text-xs",children:t.errors.password})]}),a("div",{className:"text-center mb-6 mt-4",children:A?a("div",{className:"flex justify-center",children:a(z,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})}):a("button",{type:"submit",className:"px-4 py-1.5 bg-green-200 hover:bg-green-300 rounded-md shadow-md text-sm",children:" Login "})})]})})})};export{W as default};
