import{l as d,y as z,v as F,m as H,I as O,W as G,q as g,z as J,B as N,D as K,h as b,k as a,o as f,j as e,E as Q,M as P}from"./index-4a1e28f7.js";const te=()=>{var k,M,A;const[r,S]=d.useState(),[X,m]=d.useState(!1),[c,D]=d.useState(),[v,Y]=d.useState(),[E,h]=d.useState(!1),{notify:y}=d.useContext(z),[l,w]=d.useState(),[u,Z]=d.useState(),[x,U]=d.useState(),{id:i}=F(),L=H();O("Water Demand Payment");const{api_waterApprovedApplicationDetails:T,api_waterListDemand:V,api_waterDemandCalculation:W,api_waterDemandPayment:B,header:p}=G();d.useEffect(()=>{R(),_()},[i]),d.useEffect(()=>{I()},[x,u]);const I=()=>{if(x=="")return w();m(!0);const t={consumerId:i,demandFrom:u,demandUpto:x};g.post(W,t,p).then(function(n){console.log("water demand calculation Details",n.data.data),w(n.data.data),m(!1)}).catch(function(n){console.log("Error : water calculating demand",n),m(!1)})},R=()=>{m(!0),g.post(T,{applicationId:i},p).then(function(t){console.log("water Approved Application Details",t.data.data),S(t.data.data),m(!1)}).catch(function(t){console.log("Error : water Approved Application Details",t),m(!1)})},_=()=>{g.post(V,{ConsumerId:i},p).then(t=>{console.log("Fetched Water Demand List",t.data.data),D(t.data.data)}).catch(t=>{console.log("Exception while fetching Water Demand",t)})},C=t=>{const n={consumerId:i,demandFrom:u,demandUpto:x,amount:l==null?void 0:l.totalPayAmount,paymentMode:t.paymentMode,remarks:t.remarks,chequeDate:t.cheque_dd_date,bankName:t.bankName,branchName:t.branchName,chequeNo:t.cheque_dd_no};console.log("final submit",n),h(!0),g.post(B,n,p).then(s=>{var q;s.data.status?(_(),h(!1),console.log("Demand Paid Successfully",s),y("Demand Paid Successfully","success"),L(`/waterViewPaymentHistory/${i}`)):(h(!1),console.log("Failed to paid Demand.",s),y((q=s==null?void 0:s.data)==null?void 0:q.message,"error"))}).catch(s=>{h(!1),console.log("Exception while Demand payment",s),y("Error while Demand payment","error")})},j=J({monthUpto:N().required("Require Field"),remarks:N().required("Require Field"),paymentMode:N().required("Require Field")}),o=K({enableReinitialize:!0,initialValues:{monthUpto:"",penalty:"",advanced:"",paymentMode:"",remarks:"",bankName:"",branchName:"",cheque_dd_no:"",cheque_dd_date:""},onSubmit:(t,n)=>{C(t),h(!0)},validationSchema:j}),$=t=>{let n=t.target.name,s=t.target.value;n=="paymentMode"&&Y(s),n=="monthUpto"&&U(s),n=="paymentMode"&&(o.setFieldValue("bankName",""),o.setFieldValue("branchName",""),o.setFieldValue("cheque_dd_no",""),o.setFieldValue("cheque_dd_date",""))};return(k=c==null?void 0:c.consumerDemands)==null||k.filter(t=>b(t.demand_upto,"YYYY-MM-DD").format("yy-MM").toString()>=b(u,"YYYY-MM-DD").format("yy-MM")),a(f,{children:[E&&e(Q,{}),e("div",{className:"grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 gap-2 container mx-auto w-full",children:a("div",{className:"col-span-12 rounded-lg p-4",children:[e("div",{className:"p-4",children:a("div",{className:"",children:[a("h1",{className:"px-1 font-semibold font-serif  text-gray-500",children:[e(P,{className:"inline"})," Basic Details"]}),e("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl p-4",children:a("div",{className:"flex space-x-5 pl-4 ",children:[a("div",{className:"flex-1",children:[e("div",{className:"font-semibold text-sm",children:r!=null&&r.ulb_name?r==null?void 0:r.ulb_name:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"ULB Name"})]}),a("div",{className:"flex-1",children:[e("div",{className:"font-bold text-sm",children:r!=null&&r.ward_name?r==null?void 0:r.ward_name:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"Ward No."})]}),a("div",{className:"flex-1",children:[e("div",{className:"font-bold text-sm",children:r!=null&&r.consumer_no?r==null?void 0:r.consumer_no:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"Consumer No"})]}),a("div",{className:"flex-1",children:[e("div",{className:"font-bold text-sm",children:r!=null&&r.connection_through?r==null?void 0:r.connection_through:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"Connection Through"})]}),(r==null?void 0:r.connection_through)=="SAF"?a("div",{className:"flex-1",children:[e("div",{className:"font-semibold text-md",children:r!=null&&r.saf_no?r==null?void 0:r.saf_no:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"SAF No"})]}):a("div",{className:"flex-1",children:[e("div",{className:"font-semibold text-md",children:r!=null&&r.holding_no?r==null?void 0:r.holding_no:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"Holding No"})]}),a("div",{className:"flex-1",children:[e("div",{className:"font-semibold text-md",children:r!=null&&r.owner_char_type?r==null?void 0:r.owner_char_type:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"Ownership Type"})]})]})})]})}),e(f,{children:a("div",{className:"mt-5 p-4",children:[a("h1",{className:"px-1 font-semibold font-serif text-gray-500",children:[e(P,{className:"inline"}),"Due Demand Details"]}),a("table",{className:"min-w-full leading-normal mt-2 bg-white rounded-lg shadow-xl p-4",children:[e("thead",{className:"font-bold text-left text-sm border text-gray-800 bg-white",children:a("tr",{children:[e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"#"}),e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand From"}),e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand Upto"}),e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand Amount"}),e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Penalty"}),e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Connection Type"}),e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Payable Amount "})]})}),e("tbody",{className:"text-sm",children:e(f,{children:(M=c==null?void 0:c.consumerDemands)==null?void 0:M.map((t,n)=>a("tr",{className:"bg-white shadow-xl border-b border-gray-200",children:[e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:n+1}),e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:t!=null&&t.demand_from?b(t==null?void 0:t.demand_from,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:t!=null&&t.demand_upto?b(t==null?void 0:t.demand_upto,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:t!=null&&t.balance_amount?t==null?void 0:t.balance_amount:"N/A"}),e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:t!=null&&t.penalty?t==null?void 0:t.penalty:"N/A"}),e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:t!=null&&t.connection_type?t==null?void 0:t.connection_type:"N/A"}),e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:t!=null&&t.amount?"â‚¹ "+(t==null?void 0:t.amount):"N/A"})]}))})})]})]})}),e("div",{className:"col-span-12 rounded-lg p-4",children:e("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl border border-y-gray-200 p-4",children:e("form",{onSubmit:o.handleSubmit,onChange:$,className:"p-4 relative",children:a("div",{className:"grid grid-cols-12",children:[a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Select Month Upto"]}),a("select",{...o.getFieldProps("monthUpto"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e("option",{value:"",children:"Select"}),(A=c==null?void 0:c.consumerDemands)==null?void 0:A.map((t,n)=>e("option",{value:t.demand_upto,children:b(t.demand_upto,"YYYY-MM-DD").format("MMM-yy")},n))]}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.monthUpto&&o.errors.monthUpto?o.errors.monthUpto:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Total Demand"}),e("input",{...o.getFieldProps("amount"),value:(l==null?void 0:l.totalDemand)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.amount&&o.errors.amount?o.errors.amount:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Penalty"}),e("input",{...o.getFieldProps("penalty"),value:(l==null?void 0:l.totalPenalty)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.penalty&&o.errors.penalty?o.errors.penalty:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Advanced"}),e("input",{...o.getFieldProps("advanced"),value:(l==null?void 0:l.totalAdvance)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.advanced&&o.errors.advanced?o.errors.advanced:null})]}),e("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:a("p",{children:["Remain Advance : ",e("span",{className:"text-orange-700 font-semibold",children:(l==null?void 0:l.remaningAdvanceAmount)||0})]})}),e("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:a("p",{children:[" Payable Amount : ",e("span",{className:"text-green-700 font-semibold",children:l!=null&&l.totalPayAmount?"â‚¹"+(l==null?void 0:l.totalPayAmount):0})]})}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Payment Mode"]}),a("select",{...o.getFieldProps("paymentMode"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e("option",{value:"",children:"Select"}),e("option",{value:"Cash",children:"Cash"}),e("option",{value:"Cheque",children:"Cheque"}),e("option",{value:"DD",children:"DD"}),e("option",{value:"online",children:"Online"})]}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.paymentMode&&o.errors.paymentMode?o.errors.paymentMode:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Remarks"]}),e("input",{...o.getFieldProps("remarks"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Enter new ward no."}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.remarks&&o.errors.remarks?o.errors.remarks:null})]}),(v=="Cheque"||v=="DD")&&a(f,{children:[a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Bank Name"]}),e("input",{...o.getFieldProps("bankName"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter new ward no."}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.bankName&&o.errors.bankName?o.errors.bankName:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Branch Name"]}),e("input",{...o.getFieldProps("branchName"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter new ward no."}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.branchName&&o.errors.branchName?o.errors.branchName:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Cheque/DD No"]}),e("input",{...o.getFieldProps("cheque_dd_no"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.cheque_dd_no&&o.errors.cheque_dd_no?o.errors.cheque_dd_no:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Cheque/DD Date"]}),e("input",{...o.getFieldProps("cheque_dd_date"),type:"date",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Enter new ward no."}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.cheque_dd_date&&o.errors.cheque_dd_date?o.errors.cheque_dd_date:null})]})]}),e("div",{className:"col-span-12"}),a("div",{className:"col-span-12 grid grid-cols-2 mt-10",children:[e("div",{className:""}),e("div",{className:"md:pl-10 text-right",children:e("button",{type:"submit",className:" px-6 py-2.5 bg-green-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-green-700 hover:shadow-lg focus:bg-green-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-green-800 active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:"Pay Tax"})})]})]})})})})]})})]})};export{te as default};
