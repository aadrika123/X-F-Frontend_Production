import{u as I,r as o,M as O,j as e,A as T,a as B,P as M}from"./index-QmcauDG8.js";import{u as P}from"./formik.esm-rHjH4rtJ.js";import{c as R,a as F,b as _}from"./object-TsBLBjOA.js";import{L as D}from"./Loader-7woqBTu4.js";const J="/assets/logo1-kLKoZTws.png",K=()=>{const b=I(),{notify:i,setisLoggedIn:y,setheartBeatCounter:j}=o.useContext(O),[r,v]=o.useState(null),[s,p]=o.useState(),{api_login:S}=M(),[k,d]=o.useState(!1),E=R({email:F().required("Enter email"),password:_().required("Enter password")}),n=P({initialValues:{email:"",password:""},onSubmit:t=>{A()},validationSchema:E}),m=["TAX COLLECTOR","ULB TAX COLLECTOR","TEAM LEADER"],L=o.useMemo(()=>Array.isArray(r)&&r.some(t=>m.includes(t)),[r]);o.useEffect(()=>{var t,a,l;r!=null&&(L?(i("Login Successfull !!! ","success"),window.localStorage.setItem("menuList",JSON.stringify((t=s==null?void 0:s.userDetails)==null?void 0:t.menuPermission)),window.localStorage.setItem("userName",JSON.stringify((a=s==null?void 0:s.userDetails)==null?void 0:a.userName)),window.localStorage.setItem("roles",JSON.stringify((l=s==null?void 0:s.userDetails)==null?void 0:l.role)),b("/municipal-rental")):i("You don't have permission of Tax Collector !!!","warn"))},[r]);const c=JSON.parse(window.localStorage.getItem("roles")),N=window.localStorage.getItem("token");o.useMemo(()=>Array.isArray(c)&&c.some(t=>m.includes(t)),[c,N]),o.useEffect(()=>{},[]);const A=()=>{d(!0);let t={email:n.values.email,password:n.values.password,type:"mobile"};console.log("--1--before login send...",t),T.post(S,t,B()).then(function(a){var l,u,g,x,f,w,h;console.log("login response => ",a),a.data.status==!0?(console.log("--2--login response...",a),window.localStorage.setItem("token",(u=(l=a==null?void 0:a.data)==null?void 0:l.data)==null?void 0:u.token),window.localStorage.setItem("isLoggedIn",!0),p((g=a==null?void 0:a.data)==null?void 0:g.data),v((w=(f=(x=a==null?void 0:a.data)==null?void 0:x.data)==null?void 0:f.userDetails)==null?void 0:w.role),j(C=>C+1),y(!0)):(d(!1),i((h=a==null?void 0:a.data)==null?void 0:h.message,"error"))}).catch(function(a){d(!1),console.log("--2--login error...",a),i("Something went wrong !!! ","error")})};return e.jsxs(e.Fragment,{children:[k&&e.jsx(D,{}),e.jsx("div",{className:"",children:e.jsx("div",{className:"bg-[#FDFCFE] sm:w-1/2 lg:w-1/3 w-full mx-auto h-screen",children:e.jsxs("div",{className:"bg-[#5846BE] h-1/2 w-full mx-auto rounded-b-2xl ",children:[e.jsxs("div",{className:"py-12",children:[e.jsx("img",{src:J,className:"bg-white rounded-full w-28 p-1 mx-auto "}),e.jsx("h1",{className:"text-center mt-3 font-bold text-gray-50 text-2xl",children:"AMC"})]}),e.jsx("div",{class:"min-h-screen flex items-center justify-center p-4 -mt-48  hover:scale-105 duration-500 animate__animated animate__fadeInDown  darks:bg-gray-800",children:e.jsxs("div",{class:"bg-white h-96 p-8  shadow-lg w-full max-w-md  rounded-xl",children:[e.jsx("h2",{class:"text-2xl font-semibold text-gray-800 mb-6 text-center",children:"Login"}),e.jsxs("form",{onChange:n.handleChange,onSubmit:n.handleSubmit,children:[e.jsxs("div",{class:"mb-6 ",children:[e.jsx("label",{for:"email",class:"block text-gray-600 text-sm mb-2",children:"Email"}),e.jsx("input",{type:"email",name:"email",id:"email",class:"w-full leading-5 relative py-2 px-4 rounded text-gray-800 bg-white border border-gray-300 overflow-x-auto focus:outline-none focus:border-gray-400 focus:ring-0 darks:text-gray-300 darks:bg-gray-700 darks:border-gray-700 darks:focus:border-gray-600",placeholder:"Email"})]}),e.jsxs("div",{class:"mb-4",children:[e.jsx("label",{for:"password",class:"block text-gray-600 text-sm mb-2",children:"Password"}),e.jsx("input",{type:"password",name:"password",id:"password",class:"w-full leading-5 relative py-2 px-4 rounded text-gray-800 bg-white border border-gray-300 overflow-x-auto focus:outline-none focus:border-gray-400 focus:ring-0 darks:text-gray-300 darks:bg-gray-700 darks:border-gray-700 darks:focus:border-gray-600",placeholder:"Password"})]}),e.jsx("div",{className:"text-center mt-12",children:e.jsx("button",{type:"submit",class:"w-48  bg-[#5846BE] text-white font-semibold py-2 px-4 rounded-full shadow-lg hover:bg-[#5846BE]",children:"Login"})})]})]})})]})})})]})};export{K as default};
