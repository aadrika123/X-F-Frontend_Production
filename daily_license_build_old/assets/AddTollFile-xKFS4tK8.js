import{u as Q,r as n,A as h,a as x,j as l,Q as v}from"./index-gBfpY1pG.js";import{u as Y}from"./formik.esm-YSsqLi7k.js";import{T as D}from"./ThemeStyle-mSkMd4lv.js";import{c as G,b as c}from"./object-P06IkMeH.js";import{R as J}from"./RentalApiList-X3Fn6AsX.js";import{L as K}from"./Loader-EUVlBrx1.js";import{b as W,a as X}from"./PowerupFunctions-etrSqE-5.js";import{r as Z}from"./imageResizer-H2in3q2D.js";function ue(){const{inputStyle:t,labelStyle:i}=D(),{api_UlbCircleList:F,api_locationByCircleList:T,api_addToll:S,api_getTollRateList:$}=J(),P=Q(),[g,m]=n.useState(!1),[ee,q]=n.useState(""),[C,L]=n.useState(""),[le,R]=n.useState(""),[p,V]=n.useState(),[f,E]=n.useState(),[b,_]=n.useState(),I=G({circle:c().required("This field is required"),market:c().required("This field is required"),vendorName:c().required("This field is required"),mobile:c().required("Enter mobile no.").min(10,"Enter 10 digit number").max(10,"Enter 10 digit number"),address:c().required("This field is required"),rate:c().required("This field is required"),photo1Path:c().required("This field is required")}),j=(e,r)=>{v.dismiss(),r=="success"&&v.success(e),r=="error"&&v.error(e)},s=Y({initialValues:{circle:"",market:"",vendorName:"",vendorType:"",mobile:"",address:"",rate:"",photo1Path:""},enableReinitialize:!0,onSubmit:e=>{console.log("shop data",e),z(e)},validationSchema:I}),A=e=>{console.log("target type",e.target.type),console.log("check box name",e.target.name);let r=e.target.name,o=e.target.value;r=="photo1Path"&&B(r,e.target.files[0]),r=="circle"&&M(o),r=="vendorName"&&s.setFieldValue("vendorName",W(o,s.values.vendorName,50)),r=="mobile"&&s.setFieldValue("mobile",X(o,s.values.mobile,10)),r=="rate"&&s.setFieldValue("rate",o,s.values.rate)},B=(e,r)=>{console.log("name ,fileData ",e,r),q(r),e=="photo1Path"?s.setFieldValue("photo1Path",r):s.setFieldValue("photo2Path",r);const o=new FileReader;o.onloadend=()=>{e=="photo1Path"?L(o.result):R(o.result)},o.readAsDataURL(r)};console.log("form values",s.values);const z=e=>{console.log("data in form",e);const r=new FormData;r.append("circleId",e==null?void 0:e.circle),r.append("marketId",e==null?void 0:e.market),r.append("vendorName",e==null?void 0:e.vendorName),r.append("vendorType",e==null?void 0:e.vendorType),r.append("address",e==null?void 0:e.address),r.append("rate",e==null?void 0:e.rate),r.append("mobile",e==null?void 0:e.mobile),r.append("photograph1",e==null?void 0:e.photo1Path);let o,d;o=S,d=r,console.log("request body",d),h.post("".concat(o),d,x()).then(function(a){var u,w,N,k,y;console.log("response after data submitted",(w=(u=a==null?void 0:a.data)==null?void 0:u.data)==null?void 0:w.toll_no),((N=a==null?void 0:a.data)==null?void 0:N.status)===!0?(j("submitted successfully","success"),P("/submitScreen/toll/".concat((y=(k=a==null?void 0:a.data)==null?void 0:k.data)==null?void 0:y.toll_no))):j("Failed to submit","error")}).catch(function(a){console.log("errorrr.... ",a)})};n.useEffect(()=>{U(),O()},[]);const U=()=>{h.post(F,{},x()).then(e=>{console.log("circle list 1",e.data),V(e.data.data),m(!1)}).catch(e=>{console.log(e),m(!1)})},O=()=>{h.post($,{},x()).then(e=>{console.log("circle list 1",e.data),_(e.data.data),m(!1)}).catch(e=>{console.log(e),m(!1)})},M=e=>{const r={circleId:e};h.post(T,r,x()).then(o=>{console.log("location list",o.data),o.data.status&&E(o.data.data)}).catch(o=>{console.log(o)})},H=async e=>{var d,a,u;const r=await Z((d=e==null?void 0:e.target)==null?void 0:d.files[0]),o=new File([r],(u=(a=e==null?void 0:e.target)==null?void 0:a.files[0])==null?void 0:u.name,{type:"image/*"});s.setFieldValue("photo1Path",o)};return g?l.jsx(l.Fragment,{children:l.jsx("div",{className:"min-h-screen"})}):l.jsxs(l.Fragment,{children:[g&&l.jsx(K,{}),l.jsx("div",{className:"h-screen bg-[#FDFCFE] flex flex-row flex-wrap justify-center items-center p-3",children:l.jsxs("div",{className:"bg-white shadow-xl rounded-tl-[44px]  h-full sm:w-1/2 lg:w-1/3 w-full rounded-xl",children:[l.jsx("div",{className:"bg-[#5846BE] h-32 w-full mx-auto rounded-br-[68px] rounded-tl-[44px] opacity-90",children:l.jsxs("div",{className:"p-4 pt-12",children:[l.jsx("h1",{className:"text-gray-50 font-bold capitalize text-2xl",children:"Add Toll"}),l.jsx("h1",{className:"text-gray-50 capitalize text-[12px]",children:"Rent a Toll Booth and Secure Your Spot on the Road"})]})}),l.jsx("form",{onSubmit:s.handleSubmit,onChange:A,encType:"multipart/form-data",children:l.jsxs("div",{className:"bg-[#FFFFFF]  rounded-2xl shadow-md p-4 text-xs",children:[l.jsxs("div",{className:"p-2",children:[l.jsxs("div",{class:"valid-form flex flex-wrap flex-row -mx-4",children:[l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{className:"".concat(i," inline-block mb-2 "),children:"Circle"}),l.jsxs("select",{...s.getFieldProps("circle"),className:"".concat(t," inline-block w-full relative"),children:[l.jsx("option",{selected:!0,children:"select"}),p==null?void 0:p.map(e=>l.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.circle_name},e==null?void 0:e.id))]}),l.jsx("p",{className:"text-red-500 text-xs absolute",children:s.touched.circle&&s.errors.circle?s.errors.circle:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{className:"".concat(i," inline-block mb-2 "),children:"Market"}),l.jsxs("select",{...s.getFieldProps("market"),className:"".concat(t," inline-block w-full relative"),children:[l.jsx("option",{selected:!0,children:"select"}),f==null?void 0:f.map(e=>l.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.market_name}))]}),l.jsx("p",{className:"text-red-500 text-xs absolute",children:s.touched.market&&s.errors.market?s.errors.market:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{className:"".concat(i," inline-block mb-2 "),children:"Vendor Type"}),l.jsxs("select",{...s.getFieldProps("vendorType"),className:"".concat(t," inline-block w-full relative"),children:[l.jsx("option",{selected:!0,children:"select"}),l.jsx("option",{value:"schedule",children:"Schedule"}),l.jsx("option",{value:"unschedule",children:"Unscheduled"})]}),l.jsx("p",{className:"text-red-500 text-xs absolute",children:s.touched.vendorType&&s.errors.vendorType?s.errors.vendorType:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("h1",{className:"".concat(i," inline-block mb-2"),children:"Vendor name"}),l.jsx("input",{type:"text",name:"vendorName",className:"".concat(t," inline-block w-full relative"),onChange:s.handleChange,value:s.values.vendorName}),l.jsx("p",{className:"text-red-500 text-xs absolute",children:s.touched.vendorName&&s.errors.vendorName?s.errors.vendorName:null})]})]}),l.jsxs("div",{class:"valid-form flex flex-wrap flex-row -mx-4",children:[l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("h1",{className:"".concat(i," inline-block mb-2"),children:"Mobile no."}),l.jsx("input",{type:"text",name:"mobile",className:"".concat(t," inline-block w-full relative"),onChange:s.handleChange,value:s.values.mobile}),l.jsx("p",{className:"text-red-500 text-xs absolute",children:s.touched.mobile&&s.errors.mobile?s.errors.mobile:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{className:"".concat(i," inline-block mb-2 "),children:"Landmark"}),l.jsx("input",{type:"text",name:"address",className:"".concat(t," inline-block w-full relative"),onChange:s.handleChange,value:s.values.address}),l.jsx("p",{className:"text-red-500 text-xs absolute",children:s.touched.address&&s.errors.address?s.errors.address:null})]}),l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{className:"".concat(i," inline-block mb-2 "),children:"Rate"}),l.jsxs("select",{...s.getFieldProps("rate"),className:"".concat(t," inline-block w-full relative"),children:[l.jsx("option",{selected:!0,children:"select"}),b==null?void 0:b.map(e=>l.jsxs("option",{value:e==null?void 0:e.rate,children:[e==null?void 0:e.toll_type," (Rs.",e==null?void 0:e.rate,")"]}))]}),l.jsx("p",{className:"text-red-500 text-xs absolute",children:s.touched.rate&&s.errors.rate?s.errors.rate:null})]})]}),l.jsx("div",{class:"valid-form flex flex-wrap flex-row -mx-4",children:l.jsxs("div",{class:"form-group flex-shrink max-w-full px-4 w-full md:w-1/3 mb-4",children:[l.jsx("label",{className:"".concat(i," inline-block mb-2 "),children:"Image"}),l.jsx("input",{accept:"image/*",type:"file",name:"photo1Path",className:"".concat(t," inline-block w-full relative"),onChange:e=>H(e)}),l.jsx("img",{src:"".concat(C),alt:"Upload img",className:"h-20"}),l.jsx("p",{className:"text-red-500 text-xs absolute",children:s.touched.photo1Path&&s.errors.photo1Path?s.errors.photo1Path:null})]})})]}),l.jsx("div",{className:"pb-8",children:l.jsx("button",{type:"submit",className:"bg-[#5846BE] px-7 py-2 text-white font-semibold rounded leading-5 shadow-lg w-full",children:"Save"})})]})})]})})]})}export{ue as default};
