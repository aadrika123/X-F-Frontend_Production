import{u as g,j as e,r as h,e as P,f as k,Q as u,R as b}from"./index-tSYJy2m1.js";import{P as C}from"./index-WwCza5ZD.js";import{u as v}from"./formik.esm-Cj1kbZGC.js";import{c as y,a as o,b as q}from"./index.esm-pLUSep0S.js";import{F as N}from"./FormProvider-Z88UIU_N.js";import{T as c}from"./TextField-XbeSlXOC.js";import{T as O}from"./TextAreaField-YwoxzA9i.js";import"./index-ZS4GLSQF.js";const z=y().shape({name:o().required("Name is required"),mobile:o().required("Mobile is required"),dateOfBirth:o().required("Date of Birth is required"),address:o().required("Address is required")});function B({open:l,setOpen:m}){const i=()=>m(!l),{user:a}=g(),s=v({enableReinitialize:!0,initialValues:{name:(a==null?void 0:a.name)||"",mobile:(a==null?void 0:a.mobile)||"",dateOfBirth:(a==null?void 0:a.dateOfBirth)||"",address:(a==null?void 0:a.address)||""},validationSchema:z,onSubmit:(t,{resetForm:d})=>{console.log(t),d(),i()}});return e.jsxs(N,{formik:s,children:[l&&e.jsx("div",{onClick:i,className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:"".concat(l?"flex":"hidden"," overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"),children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Update Profile"}),e.jsxs("button",{onClick:i,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsxs("div",{className:"p-4 md:p-5",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{children:e.jsx(c,{name:"name",label:"Full Name",formik:s})}),e.jsx("div",{className:"-mt-3",children:e.jsx(c,{name:"email",label:"Email",value:a==null?void 0:a.email,disabled:!0})}),e.jsx("div",{className:"-mt-3",children:e.jsx(c,{name:"mobile",label:"Mobile",formik:s,type:"number"})}),e.jsx("div",{className:"-mt-3",children:e.jsx(c,{name:"dateOfBirth",label:"Date of Birth",formik:s,type:"date"})}),e.jsx("div",{className:"-mt-3",children:e.jsx(O,{name:"address",label:"Address",formik:s})})]}),e.jsxs("div",{className:"flex items-center justify-end mt-4 gap-5",children:[e.jsx(h.Button,{type:"button",size:"sm",variant:"text",color:"red",onClick:i,className:"mr-1 bg-gray-300",children:e.jsx("span",{children:"Cancel"})}),e.jsx(h.Button,{type:"submit",size:"sm",children:e.jsx("span",{children:"UPDATE"})})]})]})]})})})]})}const A=y().shape({password:o().required("Password is required"),newPassword:o().required("New Password is required").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{6,})/,"Must Contain 6 Characters, One Uppercase, One Lowercase, One Number and One Special Case Character"),confirmPassword:o().required("Confirm Password is required").oneOf([q("newPassword"),null],"New Password must match")});function M({open:l,setOpen:m}){const i=()=>m(!l),{mutateAsync:a}=P({}),{logoutChangePassword:s}=g(),t=v({enableReinitialize:!0,initialValues:{password:"",newPassword:"",confirmPassword:""},validationSchema:A,onSubmit:async(d,{resetForm:x})=>{var n,w,j,f,p;try{const r=await a({api:k.changePassword,data:{password:d==null?void 0:d.password,newPassword:d==null?void 0:d.newPassword}});(n=r==null?void 0:r.data)!=null&&n.status?(u.success((w=r==null?void 0:r.data)==null?void 0:w.message),s()):u.error((j=r==null?void 0:r.data)==null?void 0:j.message)}catch(r){u.error((p=(f=r==null?void 0:r.response)==null?void 0:f.data)==null?void 0:p.message)}x(),i()}});return e.jsxs(N,{formik:t,children:[l&&e.jsx("div",{onClick:i,className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:"".concat(l?"flex":"hidden"," overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"),children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Change Password"}),e.jsxs("button",{onClick:i,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsxs("div",{className:"p-4 md:p-5",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx("div",{children:e.jsx(c,{name:"password",label:"Old Password",type:"password",formik:t})}),e.jsx("div",{children:e.jsx(c,{name:"newPassword",label:"New Password",type:"password",formik:t})}),e.jsx("div",{children:e.jsx(c,{name:"confirmPassword",label:"Confirm Password",type:"password",formik:t})})]}),e.jsxs("div",{className:"flex items-center justify-end mt-4 gap-5",children:[e.jsx(h.Button,{type:"button",size:"sm",variant:"text",color:"red",onClick:i,className:"mr-1 bg-gray-300",children:e.jsx("span",{children:"Cancel"})}),e.jsx(h.Button,{type:"submit",size:"sm",loading:t.isSubmitting,children:e.jsx("span",{children:"UPDATE"})})]})]})]})})})]})}function U(){const[l,m]=b.useState(!1),[i,a]=b.useState(!1),{user:s,permittedWard:t}=g(),d=()=>{m(!0)},x=()=>{a(!0)};return e.jsxs(C,{title:"Profile",children:[e.jsx(B,{open:l,setOpen:m}),e.jsx(M,{open:i,setOpen:a}),e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"p-8 bg-white shadow mt-20 rounded-2xl",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"w-32 h-32 bg-indigo-100 mx-auto rounded-full shadow-2xl absolute inset-x-0 top-0 -mt-24 flex items-center justify-center text-indigo-500",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-24 w-24",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})})}),e.jsxs("div",{className:"space-x-4 flex justify-between mt-20 md:mt-0 md:justify-center",children:[e.jsx("button",{onClick:x,className:"text-white w-full text-sm py-1 px-4 uppercase rounded bg-blue-400 hover:bg-blue-500 shadow hover:shadow-lg font-medium transition transform hover:-translate-y-0.5",children:e.jsx("small",{children:"Change Password"})}),e.jsx("button",{onClick:d,className:"text-white w-full text-sm py-2 px-4 uppercase rounded bg-gray-700 hover:bg-gray-800 shadow hover:shadow-lg font-medium transition transform hover:-translate-y-0.5",children:e.jsx("small",{children:"Edit Profile"})})]})]}),e.jsxs("div",{className:"mt-8 text-center border-b pb-8",children:[e.jsx("h1",{className:"text-xl font-medium text-gray-700",children:s==null?void 0:s.name}),e.jsx("p",{className:"font-light text-sm text-gray-600 mt-1",children:s==null?void 0:s.email}),e.jsx("p",{className:"mt-1 text-gray-500 text-sm",children:s==null?void 0:s.mobile}),e.jsx("p",{className:"mt-1 text-gray-500 text-sm",children:(s==null?void 0:s.role[0])||"Role not found"}),e.jsx("p",{className:"mt-1 text-gray-500 text-sm",children:s==null?void 0:s.address})]}),(t==null?void 0:t.length)>0&&e.jsxs("div",{className:" flex flex-col justify-center",children:[e.jsx("h1",{className:"text-sm font-bold text-gray-700",children:"Permitted Ward"}),e.jsx("div",{className:"grid grid-cols-4 mt-1",children:t==null?void 0:t.map(n=>e.jsx("div",{className:"p-1",children:e.jsx(h.Chip,{variant:"ghost",value:n==null?void 0:n.ward_name,className:"text-center"})},n==null?void 0:n.id))})]})]})}),e.jsx("div",{className:"mb-8"})]})}export{U as default};
