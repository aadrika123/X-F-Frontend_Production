import{j as e,b as ke,a as _e,p as g,S as Pe,Q as h,f as Se}from"./index-W1AIrKZX.js";import{e as i,R as y,h as Ae,u as Ce,r as Be}from"./react-HXRlOr-l.js";import{u as Oe}from"./formik.esm-BYe_KACy.js";import{c as Fe,a as ye,g as Ne}from"./index.esm-yBrOrWJe.js";import{F as Ve}from"./FormProvider-Eg1-phm1.js";import{T as Me}from"./TextField-QBgAhggy.js";import{R as ze}from"./RadioButton-W1xodKQ0.js";import{T as Ie}from"./TextAreaField-CK393TAC.js";import"./index-mWJwE1Yp.js";import{P as qe}from"./index-XLAeQlkZ.js";import{O as Le}from"./OverLayLoader-g5DV0Wpg.js";import{M as N}from"./MyPDFViewer-27kREiFA.js";import"./module-m7Ub87Bs.js";function be({open:m,setOpen:p,url:u,ext:f,title:j}){const x=()=>p(!m);return e.jsxs(e.Fragment,{children:[m&&e.jsx("div",{onClick:x,className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:"".concat(m?"flex":"hidden"," overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"),children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full ",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700 h-[500px]",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:j}),e.jsxs("button",{onClick:x,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),f==="pdf"?e.jsx(N,{fileUrl:u}):e.jsx("img",{src:u,alt:"Naksha",className:"w-full h-full"}),e.jsx("div",{className:"p-4 md:p-5",children:e.jsx("div",{className:"flex items-center justify-end mt-4 gap-5",children:e.jsx(i.Button,{type:"button",size:"sm",variant:"text",color:"red",onClick:x,className:"mr-1 bg-gray-300",children:e.jsx("span",{children:"Ok"})})})})]})})})]})}const Re=[{label:"Yes",value:"yes"},{label:"No",value:"no"}];function ss(){var w,k,_,P,S,A,C,B,O,F,V,M,z,I,q,L,R,T,D,$,E,U,Y,W,H,K,Q,Z,G,J,X,ee,se,te,ae,re,le,ie,ne,ce,de,me,oe,xe;const m=ke({}),[p,u]=y.useState(""),[f,j]=y.useState(!1),[x,b]=y.useState(!1),{id:o}=Ae(),v=Ce(),{data:s,refetch:Te,error:De,isLoading:ve}=_e({api:g.getUploadDocNaksha,config:{applicationId:o},value:[o],options:{enabled:!!o}}),t=Oe({enableReinitialize:!0,initialValues:{areaOfPlot:"",isNaksha:(w=s==null?void 0:s.data)!=null&&w.naksha?"":"no",comment:"",message:""},validationSchema:Fe({isNaksha:ye().required("Required"),comment:ye().required("Required").max(500,"Max 500 characters"),areaOfPlot:Ne().when("isNaksha",{is:"yes",then:()=>Ne().required("Required")})}),onSubmit:async r=>{Pe.fire({title:"Are you sure?",text:"You are going to verify naksha of this property ",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Proceed!",cancelButtonText:"No, cancel!",reverseButtons:!0}).then(l=>{l.isConfirmed&&we(r)}).catch(l=>{var c,d;h.error((d=(c=l==null?void 0:l.response)==null?void 0:c.data)==null?void 0:d.message)})}}),we=async r=>{var c,d,he,ue,je,pe,fe,ge;const l={applicationId:o,IsDouble:r.isNaksha==="no",areaOfPlot:r.areaOfPlot};try{const a=await m.mutateAsync({api:g.nakshaVerify,data:l});if((c=a==null?void 0:a.data)!=null&&c.status){console.log((d=a==null?void 0:a.data)==null?void 0:d.message),u((he=a==null?void 0:a.data)==null?void 0:he.message);const n=await m.mutateAsync({api:g.safLevel,data:{applicationId:o,action:"forward",comment:"Ok"}});(ue=n==null?void 0:n.data)!=null&&ue.status?(v("/amc-app/property/saf-verification-list",{replace:!0}),h.success("".concat(p," and ").concat((je=n==null?void 0:n.data)==null?void 0:je.message))):h.error((pe=n==null?void 0:n.data)==null?void 0:pe.message)}else h.error((fe=a==null?void 0:a.data)==null?void 0:fe.message)}catch(a){h.error(((ge=a==null?void 0:a.data)==null?void 0:ge.message)||"Something went wrong !")}};return Be.useEffect(()=>{var r;((r=t==null?void 0:t.values)==null?void 0:r.isNaksha)=="no"&&(t.setFieldValue("areaOfPlot",""),t.setFieldValue("message",""))},[(k=t==null?void 0:t.values)==null?void 0:k.isNaksha]),ve?e.jsx(Se,{}):e.jsxs(e.Fragment,{children:[m.isLoading&&e.jsx(Le,{}),e.jsxs(qe,{title:"Naksha Verification",children:[e.jsx(be,{open:f,setOpen:j,url:(P=(_=s==null?void 0:s.data)==null?void 0:_.naksha)==null?void 0:P.doc_path,ext:(A=(S=s==null?void 0:s.data)==null?void 0:S.naksha)==null?void 0:A.ext,title:"Sanction Plan"}),e.jsx(be,{open:x,setOpen:b,url:(B=(C=s==null?void 0:s.data)==null?void 0:C.measurement_sheet)==null?void 0:B.doc_path,ext:(F=(O=s==null?void 0:s.data)==null?void 0:O.measurement_sheet)==null?void 0:F.ext,title:"Measurement Sheet"}),e.jsxs("div",{className:"p-4",children:[e.jsxs(i.Card,{className:"w-full",children:[e.jsx("div",{className:"flex justify-between items-center px-5 bg-blue-gray-400 py-2 rounded-tl-lg rounded-tr-lg",children:e.jsx("h1",{className:"text-base font-semibold text-gray-100",children:"Basic Details"})}),e.jsx(i.CardBody,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Application No :"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(V=s==null?void 0:s.data)==null?void 0:V.saf_no})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Owner Name :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:(M=s==null?void 0:s.data)==null?void 0:M.applicant_name}),e.jsx("div",{children:e.jsxs("h1",{className:"text-sm font-semibold text-gray-900",children:["Buildup Area (",e.jsx("small",{children:"In Sqft"}),") :"]})}),e.jsx("div",{className:"text-sm  text-gray-900",children:(z=s==null?void 0:s.data)==null?void 0:z.builtup_area}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Zone :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(I=s==null?void 0:s.data)==null?void 0:I.zone})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Ward :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(q=s==null?void 0:s.data)==null?void 0:q.new_ward_no})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Property Type :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(L=s==null?void 0:s.data)==null?void 0:L.property_type})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Address :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(R=s==null?void 0:s.data)==null?void 0:R.prop_address})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Assessment Type :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(T=s==null?void 0:s.data)==null?void 0:T.assessment_type})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Application Date :"})}),e.jsx("div",{className:"text-sm  text-gray-900",children:e.jsx("h1",{className:"text-sm  text-gray-900",children:(D=s==null?void 0:s.data)==null?void 0:D.application_date})}),e.jsx("div",{className:"col-span-2 flex justify-center items-center mt-3",children:e.jsx(i.Button,{size:"sm",variant:"outlined",onClick:()=>v("/amc-app/property/saf-property-details/".concat(o)),children:e.jsx("span",{children:"View Saf Details"})})})]})})]}),e.jsx("div",{className:"border-b-2 border-gray-300 mt-3 mb-3"}),e.jsxs(i.Card,{className:"w-full",children:[e.jsx("div",{className:"flex justify-between items-center px-5 bg-blue-gray-400 py-2 rounded-tl-lg rounded-tr-lg",children:e.jsxs("h1",{className:"text-base font-semibold text-gray-100",children:["Measurement Sheet"," "]})}),($=s==null?void 0:s.data)!=null&&$.measurement_sheet?e.jsxs("div",{className:"grid grid-cols-1 gap-2 items-center",children:[((U=(E=s==null?void 0:s.data)==null?void 0:E.measurement_sheet)==null?void 0:U.ext)=="jpg"||((W=(Y=s==null?void 0:s.data)==null?void 0:Y.measurement_sheet)==null?void 0:W.ext)=="jpeg"||((K=(H=s==null?void 0:s.data)==null?void 0:H.measurement_sheet)==null?void 0:K.ext)=="png"?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("img",{src:(Z=(Q=s==null?void 0:s.data)==null?void 0:Q.measurement_sheet)==null?void 0:Z.doc_path,alt:"measurement_sheet",loading:"lazy",width:500,className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-full",children:e.jsx(N,{fileUrl:(J=(G=s==null?void 0:s.data)==null?void 0:G.measurement_sheet)==null?void 0:J.doc_path,toolbar:!1})}),e.jsx("div",{className:"flex justify-center items-center mb-5 mt-4",children:e.jsx(i.Button,{type:"button",size:"sm",color:"blue",className:"text-[11px]  h-8 justify-center items-center text-center flex",onClick:()=>b(!0),variant:"outlined",children:e.jsx("span",{children:"View Measurement"})})})]}):e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-red-900 font-semibold",children:"Sanction Plan not found!"})})]}),e.jsx("div",{className:"border-b-2 border-gray-300 mt-3 mb-3"}),e.jsxs(i.Card,{className:"w-full",children:[e.jsx("div",{className:"flex justify-between items-center px-5 bg-blue-gray-400 py-2 rounded-tl-lg rounded-tr-lg",children:e.jsx("h1",{className:"text-base font-semibold text-gray-100",children:"Sanction Plan"})}),e.jsx(i.CardBody,{children:(X=s==null?void 0:s.data)!=null&&X.naksha?e.jsxs("div",{className:"grid grid-cols-1 gap-2 items-center",children:[((se=(ee=s==null?void 0:s.data)==null?void 0:ee.naksha)==null?void 0:se.ext)=="jpg"||((ae=(te=s==null?void 0:s.data)==null?void 0:te.naksha)==null?void 0:ae.ext)=="jpeg"||((le=(re=s==null?void 0:s.data)==null?void 0:re.naksha)==null?void 0:le.ext)=="png"?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("img",{src:(ne=(ie=s==null?void 0:s.data)==null?void 0:ie.naksha)==null?void 0:ne.doc_path,alt:"naksha",loading:"lazy",width:500,className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-full",children:e.jsx(N,{fileUrl:(de=(ce=s==null?void 0:s.data)==null?void 0:ce.naksha)==null?void 0:de.doc_path})}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(i.Button,{type:"button",size:"sm",color:"blue",className:"text-[11px]  h-8 justify-center items-center text-center flex",onClick:()=>j(!0),variant:"outlined",children:e.jsx("span",{children:"View Sanction"})})})]}):e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-red-900 font-semibold",children:"Sanction Plan not found!"})})})]}),e.jsx("div",{className:"border-b-2 border-gray-300 mt-3 mb-4"}),((me=t==null?void 0:t.values)==null?void 0:me.isNaksha)=="no"&&e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("h1",{className:"text-sm font-semibold text-red-900 text-center mb-3 w-52",children:"Double taxation will be applied for this property !"})}),e.jsxs(Ve,{formik:t,children:[((oe=s==null?void 0:s.data)==null?void 0:oe.naksha)&&e.jsx("div",{className:"flex justify-center gap-4 items-center px-5 ",children:Re.map(r=>e.jsx(ze,{formik:t,name:"isNaksha",label:r.label,value:r.value},r.value))}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 items-center mt-4",children:[t.values.isNaksha==="yes"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-sm font-semibold text-gray-900"}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("h1",{className:"text-sm font-semibold text-red-900 text-center mb-3 w-52",children:(xe=t==null?void 0:t.values)==null?void 0:xe.message})})]}),e.jsx("div",{children:e.jsx(Me,{label:"Constructed Area(In Sqft) :",type:"number",formik:t,name:"areaOfPlot",placeholder:"Constructed Area (In Sqft)",onBlur:()=>{var r,l,c,d;((r=t==null?void 0:t.values)==null?void 0:r.areaOfPlot)<((l=s==null?void 0:s.data)==null?void 0:l.builtup_area)?t.setFieldValue("message","100% Taxation will be applied on ".concat(((c=s==null?void 0:s.data)==null?void 0:c.builtup_area)-((d=t==null?void 0:t.values)==null?void 0:d.areaOfPlot)," sqft constructed area !")):t.setFieldValue("message","")}})})]}),e.jsx("div",{children:e.jsx(Ie,{label:"comment",formik:t,name:"comment",placeholder:"Comment"})})]}),e.jsx("div",{className:"flex justify-center mt-4 gap-5",children:e.jsx(i.Button,{type:"submit",size:"sm",children:e.jsx("span",{children:"Forward"})})})]})]})]})]})}export{ss as default};
