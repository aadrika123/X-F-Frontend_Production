import{d as C,j as e,e as $,b as y,c as w,Q as b}from"./index-kgqcLUgD.js";import{d as q,u as A}from"./router-g9NwwHut.js";import{u as S}from"./formik.esm-MEJnthxH.js";import{c as N,a as j,b as k}from"./index.esm-lGQm42K_.js";import{F as T}from"./FormProvider-3lUJpTxm.js";import{T as R}from"./TextField-lqCZRND9.js";import{L as O}from"./LoaderButton-_UoUGn4v.js";import"./index-KJUlVKah.js";import{u as z,P as V}from"./useCountDown-n_ln07WD.js";import"./reactQuery-Q7rJjNxq.js";import"./reactQueryDevtools-6dm9iask.js";import"./axios-hq-Xw8mW.js";import"./tailwind-xMhOhnt0.js";import"./reactIcons-TqjzQo_g.js";import"./headlessui-QgKi6LbN.js";const E=[{id:0,label:"Mobile"},{id:1,label:"Email"}];function M(){const{state:d,actions:a}=C({updateAction:$});return e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"relative right-0",children:e.jsx("ul",{className:"relative flex flex-wrap p-1 list-none rounded-lg bg-blue-gray-50/60","data-tabs":"tabs",role:"list",children:E==null?void 0:E.map(s=>e.jsx("li",{className:"z-30 flex-auto text-center",onClick:()=>a==null?void 0:a.updateAction({loginTabs:s==null?void 0:s.id}),children:e.jsx("a",{className:"z-30 flex items-center justify-center w-full px-0 py-1 mb-0 transition-all ease-in-out border-0 rounded-lg cursor-pointer text-slate-700 bg-inherit ".concat(d.loginTabs===(s==null?void 0:s.id)?"border-b-2 border-blue-500 text-blue-500":""),"data-tab-target":"",role:"tab","aria-selected":"true",children:e.jsx("span",{className:"ml-1",children:s==null?void 0:s.label})})},s==null?void 0:s.id))})})})}const L=N().shape({mobile:j().required("Mobile is required").min(10).max(10)});function B({next:d,data:a,setData:s}){const{mutateAsync:h}=y({}),t=S({enableReinitialize:!0,initialValues:{mobile:a.mobile||""},validationSchema:L,onSubmit:async(o,{})=>{var g,r,l;try{const i=await h({api:w.forgotPassword,data:{mobile:o.mobile}});(g=i==null?void 0:i.data)!=null&&g.status?(d({...a,mobile:o.mobile}),b.success((r=i==null?void 0:i.data)==null?void 0:r.message)):b.error((l=i==null?void 0:i.data)==null?void 0:l.message)}catch(i){b.error(i==null?void 0:i.message)}}});return e.jsxs(T,{formik:t,children:[e.jsx("h2",{className:" font-semibold mt-8 mb-4",children:"Send OTP"}),e.jsx(R,{label:"Mobile",name:"mobile",type:"number",formik:t,placeholder:"Enter your register mobile no"}),e.jsx(O,{type:t.isSubmitting?"button":"submit",disabled:t.isSubmitting,loading:t.isSubmitting,children:"SEND OTP"})]})}const Q=N().shape({otp:j().required("OTP is required")});function W({next:d,data:a,setData:s,prev:h,state:t}){const{minutes:o,seconds:g,togglerTimer:r,runTimer:l}=z(.5),{mutateAsync:i,isLoading:P}=y({}),n=S({enableReinitialize:!0,initialValues:{mobile:a.mobile||"",email:a.email||"",otp:a.otp||""},validationSchema:Q,onSubmit:async(x,{})=>{var p,f,m,D,F;try{const c=await i({api:w.otpVerify,data:(t==null?void 0:t.loginTabs)==0?{mobile:x.mobile,Otp:x==null?void 0:x.otp}:{email:x.email,Otp:x==null?void 0:x.otp}});(p=c==null?void 0:c.data)!=null&&p.status?(d({...a,otp:x.otp,token:(m=(f=c==null?void 0:c.data)==null?void 0:f.data)==null?void 0:m.token}),b.success((D=c==null?void 0:c.data)==null?void 0:D.message)):b.error((F=c==null?void 0:c.data)==null?void 0:F.message)}catch(c){b.error(c==null?void 0:c.message)}}});q.useEffect(()=>(r(),()=>{r()}),[]);const u=async()=>{var x,p,f;try{const m=await i({api:w.forgotPassword,data:(t==null?void 0:t.loginTabs)==0?{mobile:a.mobile}:{email:a.email}});(x=m==null?void 0:m.data)!=null&&x.status?(b.success((p=m==null?void 0:m.data)==null?void 0:p.message),s({...a,otp:""}),n.setFieldValue("otp",""),r()):b.error((f=m==null?void 0:m.data)==null?void 0:f.message)}catch(m){b.error(m==null?void 0:m.message)}};return e.jsxs(T,{formik:n,children:[e.jsxs("h1",{className:"text-sm mt-8 mb-4",children:["Please enter the 6-digit verification code sent to"," ",t.loginTabs==0?" your phone number":"your email-:  ",t.loginTabs==0?"+"+(n==null?void 0:n.values.mobile):n==null?void 0:n.values.email," ",e.jsx("span",{className:"text-sm text-blue-700",onClick:()=>h(t.loginTabs==0?{mobile:n==null?void 0:n.values.mobile,otp:""}:{email:n==null?void 0:n.values.email,otp:""}),children:"Edit"})]}),e.jsx(R,{label:"Verify OTP",name:"otp",type:"text",formik:n}),e.jsx(O,{type:n.isSubmitting?"button":"submit",disabled:n.isSubmitting,loading:n.isSubmitting,children:"Verify OTP"}),e.jsxs("div",{className:"text-center mt-12 text-sm",children:["Didn't receive the code?"," ",P?e.jsx("small",{className:"text-gray-700 text-sm",children:"Please wait..."}):e.jsx(e.Fragment,{children:l?e.jsxs("span",{className:"text-gray-700 cursor-pointer",children:["Resend in ",o,":",g]}):e.jsx("span",{className:"text-blue-700 cursor-pointer",onClick:u,children:"Resend OTP"})})]})]})}const G=N().shape({newPassword:j().required("New Password is required"),confirmPassword:j().required("Confirm Password is required").oneOf([k("newPassword"),null],"Passwords must match")});function H({next:d,data:a,setData:s,prev:h,state:t}){z(5);const o=A(),{mutateAsync:g}=y({}),r=S({enableReinitialize:!0,initialValues:{newPassword:"",confirmPassword:""},validationSchema:G,onSubmit:async(l,{})=>{var i,P,n;try{const u=await g({api:w.resetPassword,data:{token:a==null?void 0:a.token,password:l==null?void 0:l.newPassword}});(i=u==null?void 0:u.data)!=null&&i.status?(d(l,!0),b.success((P=u==null?void 0:u.data)==null?void 0:P.message),o("/auth/login")):b.error((n=u==null?void 0:u.data)==null?void 0:n.message)}catch(u){b.error(u==null?void 0:u.message)}}});return e.jsxs(T,{formik:r,children:[e.jsx("h1",{className:"text-lg mt-5 mb-4 font-semibold",children:"Create New Password"}),e.jsx(V,{label:"New Password",name:"newPassword",formik:r}),e.jsx(V,{label:"Confirm Password",name:"confirmPassword",formik:r}),e.jsx(O,{type:r.isSubmitting?"button":"submit",disabled:r.isSubmitting,loading:r.isSubmitting,children:"RESET PASSWORD"})]})}const I=N().shape({email:j().required("Email is required").email()});function J({next:d,data:a,setData:s}){const{mutateAsync:h}=y({}),t=S({enableReinitialize:!0,initialValues:{email:a.email||""},validationSchema:I,onSubmit:async(o,{})=>{var g,r,l;try{const i=await h({api:w.forgotPassword,data:{email:o==null?void 0:o.email}});(g=i==null?void 0:i.data)!=null&&g.status?(d({...a,email:o==null?void 0:o.email}),b.success((r=i==null?void 0:i.data)==null?void 0:r.message)):b.error((l=i==null?void 0:i.data)==null?void 0:l.message)}catch(i){b.error(i==null?void 0:i.message)}}});return e.jsxs(T,{formik:t,children:[e.jsx("h2",{className:" font-semibold mt-8 mb-4",children:"Send OTP"}),e.jsx(R,{label:"Email *",name:"email",type:"email",formik:t,placeholder:"Enter your register email id"}),e.jsx(O,{type:t.isSubmitting?"button":"submit",disabled:t.isSubmitting,loading:t.isSubmitting,children:"SEND OTP"})]})}function le(){const{state:d,actions:a}=C({updateAction:$}),[s,h]=q.useState(0),[t,o]=q.useState({mobile:"",email:"",otp:"",newPassword:"",confirmPassword:"",token:""}),g=(l,i=!1)=>{o({...t,...l}),!i&&h(s+1)},r=l=>{o({...t,...l}),h(s-1)};return e.jsxs(e.Fragment,{children:[s===0&&e.jsx(M,{}),e.jsx("div",{children:{0:d.loginTabs==0?e.jsx(B,{state:d,next:g,data:t,setData:o}):e.jsx(J,{state:d,next:g,data:t,setData:o}),1:e.jsx(W,{state:d,next:g,prev:r,data:t,setData:o}),2:e.jsx(H,{state:d,next:g,prev:r,data:t,setData:o})}[s]})]})}export{le as default};
